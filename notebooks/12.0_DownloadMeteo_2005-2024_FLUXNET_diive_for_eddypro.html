
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Auto-settings &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/12.0_DownloadMeteo_2005-2024_FLUXNET_diive_for_eddypro';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="../text1.html">Text 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Flux_Calculations.html">Flux Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Flux_Post-processing.html">Flux Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Links.html">Links</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/12.0_DownloadMeteo_2005-2024_FLUXNET_diive_for_eddypro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/12.0_DownloadMeteo_2005-2024_FLUXNET_diive_for_eddypro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Auto-settings</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Auto-settings</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-settings">Data settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download"><strong>Download</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-fluxnet-meteo-data-2005-2023">Download FLUXNET meteo data (2005-2023)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-newest-meteo-data-from-diive-meteoscreening-2024">Download newest meteo data from diive meteoscreening (2024)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-units-if-needed"><strong>Adjust units</strong> (if needed)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-variables-for-merging-and-for-use-in-eddypro"><strong>Rename variables for merging and for use in EddyPro</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data"><strong>Merge data</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sanitize-timestamp"><strong>Sanitize timestamp</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#gap-filling"><strong>Gap-filling</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rg">Rg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ta">TA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ppfd">PPFD</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plots"><strong>Plots</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-plot">Time series plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heatmaps">Heatmaps</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats"><strong>Stats</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#keep-relevant-columns"><strong>Keep relevant columns</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-timestamp-columns-for-eddypro"><strong>Add timestamp columns for EddyPro</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-units-for-eddypro-input-file"><strong>Add units for EddyPro input file</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#set-missing-values-code-to-9999"><strong>Set missing values code</strong> to -9999</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-to-file"><strong>Save to file</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-notebook"><strong>End of notebook</strong>.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus">(Bonus)</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <span style='background:#DCEDC8; font-size:30px; display:block; border-left:40px solid #C5E1A5; padding-left:40px;'>
<b>
    Download multiple meteoscreening variables
</b>
</span><p><strong>notebook version</strong>: <code class="docutils literal notranslate"><span class="pre">3</span></code> (4 Jul 2024)<br />
<strong>new in this version</strong>: added check if downloaded data is indeed in 30MIN time resolution</p>
<ul class="simple">
<li><p>This notebook can be used to download data from the database <code class="docutils literal notranslate"><span class="pre">InfluxDB</span></code></p></li>
<li><p>Data are stored to a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file in this folder</p></li>
</ul>
</br><section class="tex2jax_ignore mathjax_ignore" id="auto-settings">
<h1><strong>Auto-settings</strong><a class="headerlink" href="#auto-settings" title="Link to this heading">#</a></h1>
<section id="data-settings">
<h2>Data settings<a class="headerlink" href="#data-settings" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIRCONF</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;L:\Sync\luhk_work\20 - CODING\22 - POET\configs&#39;</span>
<span class="c1"># DIRCONF = r&#39;P:\Flux\RDS_calculations\_scripts\_configs\configs&#39;  # Folder with configuration files: needed e.g. for connection to database</span>
<span class="n">TIMEZONE_OFFSET_TO_UTC_HOURS</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Timezone, e.g. &quot;1&quot; is translated to timezone &quot;UTC+01:00&quot; (CET, winter time)</span>
<span class="n">REQUIRED_TIME_RESOLUTION</span> <span class="o">=</span> <span class="s1">&#39;30min&#39;</span>  <span class="c1"># 30MIN time resolution</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">importlib.metadata</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gridspec</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">diive.core.plotting.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dbc_influxdb</span><span class="w"> </span><span class="kn">import</span> <span class="n">dbcInflux</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">diive.core.plotting.heatmap_datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">HeatmapDateTime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">diive.core.times.times</span><span class="w"> </span><span class="kn">import</span> <span class="n">DetectFrequency</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">diive.core.times.times</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimestampSanitizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">diive.pkgs.createvar.potentialradiation</span><span class="w"> </span><span class="kn">import</span> <span class="n">potrad</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">diive.pkgs.gapfilling.xgboost_ts</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBoostTS</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">influxdb_client.client.warnings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MissingPivotFunction</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
<span class="n">dt_string</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<span class="n">version_diive</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s2">&quot;diive&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;diive version: v</span><span class="si">{</span><span class="n">version_diive</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">version_dbc</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s2">&quot;dbc_influxdb&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dbc-influxdb version: v</span><span class="si">{</span><span class="n">version_dbc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">dbc</span> <span class="o">=</span> <span class="n">dbcInflux</span><span class="p">(</span><span class="n">dirconf</span><span class="o">=</span><span class="n">DIRCONF</span><span class="p">)</span>  <span class="c1"># Connect to database</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
</br></section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="download">
<h1><strong>Download</strong><a class="headerlink" href="#download" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">OUTFILE</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;meteo6_2005-2024.csv&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="download-fluxnet-meteo-data-2005-2023">
<h2>Download FLUXNET meteo data (2005-2023)<a class="headerlink" href="#download-fluxnet-meteo-data-2005-2023" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">data_simple_fluxnet</span><span class="p">,</span> <span class="n">data_detailed_fluxnet</span><span class="p">,</span> <span class="n">assigned_measurements_fluxnet</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
    <span class="n">bucket</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ch-cha_processed&#39;</span><span class="p">,</span>
    <span class="n">measurements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TA&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span> <span class="s1">&#39;LW&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD&#39;</span><span class="p">,</span> <span class="s1">&#39;SW&#39;</span><span class="p">,</span> <span class="s1">&#39;PA&#39;</span><span class="p">],</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TA_F&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span> <span class="s1">&#39;LW_IN_F&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD_IN&#39;</span><span class="p">,</span> <span class="s1">&#39;SW_IN_F&#39;</span><span class="p">,</span> <span class="s1">&#39;PA_F&#39;</span><span class="p">],</span>
    <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2005-01-01 00:00:01&#39;</span><span class="p">,</span>  <span class="c1"># Download data starting with this date (the start date itself IS included),</span>
    <span class="n">stop</span><span class="o">=</span><span class="s1">&#39;2024-01-01 00:00:01&#39;</span><span class="p">,</span>  <span class="c1"># Download data before this date (the stop date itself IS NOT included),</span>
    <span class="n">timezone_offset_to_utc_hours</span><span class="o">=</span><span class="n">TIMEZONE_OFFSET_TO_UTC_HOURS</span><span class="p">,</span>
    <span class="n">data_version</span><span class="o">=</span><span class="s1">&#39;fluxnet_v2024&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOWNLOADING
    from bucket ch-cha_processed
    variables [&#39;TA_F&#39;, &#39;RH&#39;, &#39;LW_IN_F&#39;, &#39;PPFD_IN&#39;, &#39;SW_IN_F&#39;, &#39;PA_F&#39;]
    from measurements [&#39;TA&#39;, &#39;RH&#39;, &#39;LW&#39;, &#39;PPFD&#39;, &#39;SW&#39;, &#39;PA&#39;]
    from data version fluxnet_v2024
    between 2005-01-01 00:00:01 and 2024-01-01 00:00:01
    with timezone offset to UTC of 1
Used querystring: from(bucket: &quot;ch-cha_processed&quot;) |&gt; range(start: 2005-01-01T00:00:01+01:00, stop: 2024-01-01T00:00:01+01:00) |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;TA&quot; or r[&quot;_measurement&quot;] == &quot;RH&quot; or r[&quot;_measurement&quot;] == &quot;LW&quot; or r[&quot;_measurement&quot;] == &quot;PPFD&quot; or r[&quot;_measurement&quot;] == &quot;SW&quot; or r[&quot;_measurement&quot;] == &quot;PA&quot;) |&gt; filter(fn: (r) =&gt; r[&quot;data_version&quot;] == &quot;fluxnet_v2024&quot;) |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;TA_F&quot; or r[&quot;_field&quot;] == &quot;RH&quot; or r[&quot;_field&quot;] == &quot;LW_IN_F&quot; or r[&quot;_field&quot;] == &quot;PPFD_IN&quot; or r[&quot;_field&quot;] == &quot;SW_IN_F&quot; or r[&quot;_field&quot;] == &quot;PA_F&quot;) |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;_field&quot;], valueColumn: &quot;_value&quot;)
querystring was constructed from:
    bucketstring: from(bucket: &quot;ch-cha_processed&quot;)
    rangestring: |&gt; range(start: 2005-01-01T00:00:01+01:00, stop: 2024-01-01T00:00:01+01:00)
    measurementstring: |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;TA&quot; or r[&quot;_measurement&quot;] == &quot;RH&quot; or r[&quot;_measurement&quot;] == &quot;LW&quot; or r[&quot;_measurement&quot;] == &quot;PPFD&quot; or r[&quot;_measurement&quot;] == &quot;SW&quot; or r[&quot;_measurement&quot;] == &quot;PA&quot;)
    dataversionstring: |&gt; filter(fn: (r) =&gt; r[&quot;data_version&quot;] == &quot;fluxnet_v2024&quot;)
    fieldstring: |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;TA_F&quot; or r[&quot;_field&quot;] == &quot;RH&quot; or r[&quot;_field&quot;] == &quot;LW_IN_F&quot; or r[&quot;_field&quot;] == &quot;PPFD_IN&quot; or r[&quot;_field&quot;] == &quot;SW_IN_F&quot; or r[&quot;_field&quot;] == &quot;PA_F&quot;)
    pivotstring: |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;_field&quot;], valueColumn: &quot;_value&quot;)
Download finished.
Downloaded data for 6 variables:
&lt;-- LW_IN_F  (333072 records)  first date: 2005-01-01 00:30:00  last date: 2024-01-01 00:00:00
&lt;-- PA_F  (333072 records)  first date: 2005-01-01 00:30:00  last date: 2024-01-01 00:00:00
&lt;-- PPFD_IN  (316404 records)  first date: 2005-09-09 10:00:00  last date: 2024-01-01 00:00:00
&lt;-- RH  (264606 records)  first date: 2005-09-09 10:30:00  last date: 2024-01-01 00:00:00
&lt;-- SW_IN_F  (333072 records)  first date: 2005-01-01 00:30:00  last date: 2024-01-01 00:00:00
&lt;-- TA_F  (333072 records)  first date: 2005-01-01 00:30:00  last date: 2024-01-01 00:00:00
========================================
Fields in measurement TA of bucket ch-cha_processed:
#1  ch-cha_processed  TA  TA
#2  ch-cha_processed  TA  TA_1_1_1
#3  ch-cha_processed  TA  TA_EP
#4  ch-cha_processed  TA  TA_ERA
#5  ch-cha_processed  TA  TA_F
#6  ch-cha_processed  TA  TA_F_MDS
#7  ch-cha_processed  TA  TA_F_MDS_QC
#8  ch-cha_processed  TA  TA_F_QC
#9  ch-cha_processed  TA  TA_SOURCE
#10  ch-cha_processed  TA  TA_T1_2_1
#11  ch-cha_processed  TA  T_SONIC
Found 11 fields in measurement TA of bucket ch-cha_processed.
========================================
========================================
Fields in measurement RH of bucket ch-cha_processed:
#1  ch-cha_processed  RH  RH
#2  ch-cha_processed  RH  RH_1_1_1
#3  ch-cha_processed  RH  RH_EP
#4  ch-cha_processed  RH  RH_SCALED_T1_2_1
#5  ch-cha_processed  RH  RH_SOURCE
#6  ch-cha_processed  RH  RH_T1_2_1
Found 6 fields in measurement RH of bucket ch-cha_processed.
========================================
========================================
Fields in measurement LW of bucket ch-cha_processed:
#1  ch-cha_processed  LW  LW_IN
#2  ch-cha_processed  LW  LW_IN_1_1_1
#3  ch-cha_processed  LW  LW_IN_ERA
#4  ch-cha_processed  LW  LW_IN_F
#5  ch-cha_processed  LW  LW_IN_F_MDS
#6  ch-cha_processed  LW  LW_IN_F_MDS_QC
#7  ch-cha_processed  LW  LW_IN_F_QC
#8  ch-cha_processed  LW  LW_IN_JSB
#9  ch-cha_processed  LW  LW_IN_JSB_ERA
#10  ch-cha_processed  LW  LW_IN_JSB_F
#11  ch-cha_processed  LW  LW_IN_JSB_F_QC
#12  ch-cha_processed  LW  LW_IN_JSB_QC
#13  ch-cha_processed  LW  LW_IN_T1_2_1
#14  ch-cha_processed  LW  LW_OUT
#15  ch-cha_processed  LW  LW_OUT_T1_2_1
Found 15 fields in measurement LW of bucket ch-cha_processed.
========================================
========================================
Fields in measurement PPFD of bucket ch-cha_processed:
#1  ch-cha_processed  PPFD  PPFD_IN
#2  ch-cha_processed  PPFD  PPFD_IN_1_1_1
#3  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_SETTO_0_T1_2_1
#4  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_SETTO_0_T1_2_2
#5  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_T1_2_1
#6  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_T1_2_2
#7  ch-cha_processed  PPFD  PPFD_IN_T1_2_1
#8  ch-cha_processed  PPFD  PPFD_IN_T1_2_2
#9  ch-cha_processed  PPFD  PPFD_OUT_CORRECTED_SETTO_0_T1_2_2
#10  ch-cha_processed  PPFD  PPFD_OUT_CORRECTED_T1_2_2
#11  ch-cha_processed  PPFD  PPFD_OUT_T1_2_2
Found 11 fields in measurement PPFD of bucket ch-cha_processed.
========================================
========================================
Fields in measurement SW of bucket ch-cha_processed:
#1  ch-cha_processed  SW  NIGHT
#2  ch-cha_processed  SW  SW_IN
#3  ch-cha_processed  SW  SW_IN_1_1_1
#4  ch-cha_processed  SW  SW_IN_AZI_4
#5  ch-cha_processed  SW  SW_IN_CORRECTED_SETTO_0_T1_2_1
#6  ch-cha_processed  SW  SW_IN_CORRECTED_T1_2_1
#7  ch-cha_processed  SW  SW_IN_ELE_4
#8  ch-cha_processed  SW  SW_IN_ERA
#9  ch-cha_processed  SW  SW_IN_F
#10  ch-cha_processed  SW  SW_IN_F_MDS
#11  ch-cha_processed  SW  SW_IN_F_MDS_QC
#12  ch-cha_processed  SW  SW_IN_F_QC
#13  ch-cha_processed  SW  SW_IN_POT
#14  ch-cha_processed  SW  SW_IN_SOURCE
#15  ch-cha_processed  SW  SW_IN_T1_2_1
#16  ch-cha_processed  SW  SW_OUT
#17  ch-cha_processed  SW  SW_OUT_CORRECTED_SETTO_0_T1_2_1
#18  ch-cha_processed  SW  SW_OUT_CORRECTED_T1_2_1
#19  ch-cha_processed  SW  SW_OUT_T1_2_1
Found 19 fields in measurement SW of bucket ch-cha_processed.
========================================
========================================
Fields in measurement PA of bucket ch-cha_processed:
#1  ch-cha_processed  PA  CUSTOM_AIR_P_MEAN
#2  ch-cha_processed  PA  PA
#3  ch-cha_processed  PA  PA_1_1_1
#4  ch-cha_processed  PA  PA_EP
#5  ch-cha_processed  PA  PA_ERA
#6  ch-cha_processed  PA  PA_F
#7  ch-cha_processed  PA  PA_F_QC
#8  ch-cha_processed  PA  PA_GF1_0.9_1
#9  ch-cha_processed  PA  PA_SOURCE
Found 9 fields in measurement PA of bucket ch-cha_processed.
========================================
CPU times: total: 36.3 s
Wall time: 54.1 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_simple_fluxnet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LW_IN_F</th>
      <th>PA_F</th>
      <th>PPFD_IN</th>
      <th>RH</th>
      <th>SW_IN_F</th>
      <th>TA_F</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>331.462</td>
      <td>98.160</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.241</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>331.462</td>
      <td>98.163</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.273</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>330.270</td>
      <td>98.167</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.305</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>330.270</td>
      <td>98.173</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.284</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>323.555</td>
      <td>98.180</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.264</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2023-12-31 22:00:00</th>
      <td>327.407</td>
      <td>96.497</td>
      <td>0.0</td>
      <td>99.5571</td>
      <td>0.0</td>
      <td>1.541</td>
    </tr>
    <tr>
      <th>2023-12-31 22:30:00</th>
      <td>327.958</td>
      <td>96.505</td>
      <td>0.0</td>
      <td>98.9703</td>
      <td>0.0</td>
      <td>2.052</td>
    </tr>
    <tr>
      <th>2023-12-31 23:00:00</th>
      <td>328.606</td>
      <td>96.526</td>
      <td>0.0</td>
      <td>97.6652</td>
      <td>0.0</td>
      <td>2.223</td>
    </tr>
    <tr>
      <th>2023-12-31 23:30:00</th>
      <td>328.278</td>
      <td>96.553</td>
      <td>0.0</td>
      <td>97.2181</td>
      <td>0.0</td>
      <td>2.207</td>
    </tr>
    <tr>
      <th>2024-01-01 00:00:00</th>
      <td>328.592</td>
      <td>96.569</td>
      <td>0.0</td>
      <td>96.6339</td>
      <td>0.0</td>
      <td>2.299</td>
    </tr>
  </tbody>
</table>
<p>333072 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="download-newest-meteo-data-from-diive-meteoscreening-2024">
<h2>Download newest meteo data from diive meteoscreening (2024)<a class="headerlink" href="#download-newest-meteo-data-from-diive-meteoscreening-2024" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">data_simple</span><span class="p">,</span> <span class="n">data_detailed</span><span class="p">,</span> <span class="n">assigned_measurements</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
    <span class="n">bucket</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ch-cha_processed&#39;</span><span class="p">,</span>
    <span class="n">measurements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TA&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span> <span class="s1">&#39;LW&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD&#39;</span><span class="p">,</span> <span class="s1">&#39;SW&#39;</span><span class="p">,</span> <span class="s1">&#39;PA&#39;</span><span class="p">],</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TA_T1_2_1&#39;</span><span class="p">,</span> <span class="s1">&#39;RH_T1_2_1&#39;</span><span class="p">,</span> <span class="s1">&#39;LW_IN_T1_2_1&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD_IN_T1_2_2&#39;</span><span class="p">,</span> <span class="s1">&#39;SW_IN_T1_2_1&#39;</span><span class="p">,</span> <span class="s1">&#39;PA_GF1_0.9_1&#39;</span><span class="p">],</span>
    <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2024-01-01 00:00:01&#39;</span><span class="p">,</span>  <span class="c1"># Download data starting with this date (the start date itself IS included),</span>
    <span class="n">stop</span><span class="o">=</span><span class="s1">&#39;2025-01-01 00:00:01&#39;</span><span class="p">,</span>  <span class="c1"># Download data before this date (the stop date itself IS NOT included),</span>
    <span class="n">timezone_offset_to_utc_hours</span><span class="o">=</span><span class="n">TIMEZONE_OFFSET_TO_UTC_HOURS</span><span class="p">,</span>
    <span class="n">data_version</span><span class="o">=</span><span class="s1">&#39;meteoscreening_diive&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DOWNLOADING
    from bucket ch-cha_processed
    variables [&#39;TA_T1_2_1&#39;, &#39;RH_T1_2_1&#39;, &#39;LW_IN_T1_2_1&#39;, &#39;PPFD_IN_T1_2_2&#39;, &#39;SW_IN_T1_2_1&#39;, &#39;PA_GF1_0.9_1&#39;]
    from measurements [&#39;TA&#39;, &#39;RH&#39;, &#39;LW&#39;, &#39;PPFD&#39;, &#39;SW&#39;, &#39;PA&#39;]
    from data version meteoscreening_diive
    between 2024-01-01 00:00:01 and 2025-01-01 00:00:01
    with timezone offset to UTC of 1
Used querystring: from(bucket: &quot;ch-cha_processed&quot;) |&gt; range(start: 2024-01-01T00:00:01+01:00, stop: 2025-01-01T00:00:01+01:00) |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;TA&quot; or r[&quot;_measurement&quot;] == &quot;RH&quot; or r[&quot;_measurement&quot;] == &quot;LW&quot; or r[&quot;_measurement&quot;] == &quot;PPFD&quot; or r[&quot;_measurement&quot;] == &quot;SW&quot; or r[&quot;_measurement&quot;] == &quot;PA&quot;) |&gt; filter(fn: (r) =&gt; r[&quot;data_version&quot;] == &quot;meteoscreening_diive&quot;) |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;TA_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;RH_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;LW_IN_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;PPFD_IN_T1_2_2&quot; or r[&quot;_field&quot;] == &quot;SW_IN_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;PA_GF1_0.9_1&quot;) |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;_field&quot;], valueColumn: &quot;_value&quot;)
querystring was constructed from:
    bucketstring: from(bucket: &quot;ch-cha_processed&quot;)
    rangestring: |&gt; range(start: 2024-01-01T00:00:01+01:00, stop: 2025-01-01T00:00:01+01:00)
    measurementstring: |&gt; filter(fn: (r) =&gt; r[&quot;_measurement&quot;] == &quot;TA&quot; or r[&quot;_measurement&quot;] == &quot;RH&quot; or r[&quot;_measurement&quot;] == &quot;LW&quot; or r[&quot;_measurement&quot;] == &quot;PPFD&quot; or r[&quot;_measurement&quot;] == &quot;SW&quot; or r[&quot;_measurement&quot;] == &quot;PA&quot;)
    dataversionstring: |&gt; filter(fn: (r) =&gt; r[&quot;data_version&quot;] == &quot;meteoscreening_diive&quot;)
    fieldstring: |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;TA_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;RH_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;LW_IN_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;PPFD_IN_T1_2_2&quot; or r[&quot;_field&quot;] == &quot;SW_IN_T1_2_1&quot; or r[&quot;_field&quot;] == &quot;PA_GF1_0.9_1&quot;)
    pivotstring: |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;_field&quot;], valueColumn: &quot;_value&quot;)
Download finished.
Downloaded data for 6 variables:
&lt;-- LW_IN_T1_2_1  (17555 records)  first date: 2024-01-01 00:30:00  last date: 2025-01-01 00:00:00
&lt;-- PA_GF1_0.9_1  (17553 records)  first date: 2024-01-01 00:30:00  last date: 2025-01-01 00:00:00
&lt;-- PPFD_IN_T1_2_2  (17548 records)  first date: 2024-01-01 00:30:00  last date: 2025-01-01 00:00:00
&lt;-- RH_T1_2_1  (17543 records)  first date: 2024-01-01 00:30:00  last date: 2025-01-01 00:00:00
&lt;-- SW_IN_T1_2_1  (17555 records)  first date: 2024-01-01 00:30:00  last date: 2025-01-01 00:00:00
&lt;-- TA_T1_2_1  (17543 records)  first date: 2024-01-01 00:30:00  last date: 2025-01-01 00:00:00
========================================
Fields in measurement TA of bucket ch-cha_processed:
#1  ch-cha_processed  TA  TA
#2  ch-cha_processed  TA  TA_1_1_1
#3  ch-cha_processed  TA  TA_EP
#4  ch-cha_processed  TA  TA_ERA
#5  ch-cha_processed  TA  TA_F
#6  ch-cha_processed  TA  TA_F_MDS
#7  ch-cha_processed  TA  TA_F_MDS_QC
#8  ch-cha_processed  TA  TA_F_QC
#9  ch-cha_processed  TA  TA_SOURCE
#10  ch-cha_processed  TA  TA_T1_2_1
#11  ch-cha_processed  TA  T_SONIC
Found 11 fields in measurement TA of bucket ch-cha_processed.
========================================
========================================
Fields in measurement RH of bucket ch-cha_processed:
#1  ch-cha_processed  RH  RH
#2  ch-cha_processed  RH  RH_1_1_1
#3  ch-cha_processed  RH  RH_EP
#4  ch-cha_processed  RH  RH_SCALED_T1_2_1
#5  ch-cha_processed  RH  RH_SOURCE
#6  ch-cha_processed  RH  RH_T1_2_1
Found 6 fields in measurement RH of bucket ch-cha_processed.
========================================
========================================
Fields in measurement LW of bucket ch-cha_processed:
#1  ch-cha_processed  LW  LW_IN
#2  ch-cha_processed  LW  LW_IN_1_1_1
#3  ch-cha_processed  LW  LW_IN_ERA
#4  ch-cha_processed  LW  LW_IN_F
#5  ch-cha_processed  LW  LW_IN_F_MDS
#6  ch-cha_processed  LW  LW_IN_F_MDS_QC
#7  ch-cha_processed  LW  LW_IN_F_QC
#8  ch-cha_processed  LW  LW_IN_JSB
#9  ch-cha_processed  LW  LW_IN_JSB_ERA
#10  ch-cha_processed  LW  LW_IN_JSB_F
#11  ch-cha_processed  LW  LW_IN_JSB_F_QC
#12  ch-cha_processed  LW  LW_IN_JSB_QC
#13  ch-cha_processed  LW  LW_IN_T1_2_1
#14  ch-cha_processed  LW  LW_OUT
#15  ch-cha_processed  LW  LW_OUT_T1_2_1
Found 15 fields in measurement LW of bucket ch-cha_processed.
========================================
========================================
Fields in measurement PPFD of bucket ch-cha_processed:
#1  ch-cha_processed  PPFD  PPFD_IN
#2  ch-cha_processed  PPFD  PPFD_IN_1_1_1
#3  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_SETTO_0_T1_2_1
#4  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_SETTO_0_T1_2_2
#5  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_T1_2_1
#6  ch-cha_processed  PPFD  PPFD_IN_CORRECTED_T1_2_2
#7  ch-cha_processed  PPFD  PPFD_IN_T1_2_1
#8  ch-cha_processed  PPFD  PPFD_IN_T1_2_2
#9  ch-cha_processed  PPFD  PPFD_OUT_CORRECTED_SETTO_0_T1_2_2
#10  ch-cha_processed  PPFD  PPFD_OUT_CORRECTED_T1_2_2
#11  ch-cha_processed  PPFD  PPFD_OUT_T1_2_2
Found 11 fields in measurement PPFD of bucket ch-cha_processed.
========================================
========================================
Fields in measurement SW of bucket ch-cha_processed:
#1  ch-cha_processed  SW  NIGHT
#2  ch-cha_processed  SW  SW_IN
#3  ch-cha_processed  SW  SW_IN_1_1_1
#4  ch-cha_processed  SW  SW_IN_AZI_4
#5  ch-cha_processed  SW  SW_IN_CORRECTED_SETTO_0_T1_2_1
#6  ch-cha_processed  SW  SW_IN_CORRECTED_T1_2_1
#7  ch-cha_processed  SW  SW_IN_ELE_4
#8  ch-cha_processed  SW  SW_IN_ERA
#9  ch-cha_processed  SW  SW_IN_F
#10  ch-cha_processed  SW  SW_IN_F_MDS
#11  ch-cha_processed  SW  SW_IN_F_MDS_QC
#12  ch-cha_processed  SW  SW_IN_F_QC
#13  ch-cha_processed  SW  SW_IN_POT
#14  ch-cha_processed  SW  SW_IN_SOURCE
#15  ch-cha_processed  SW  SW_IN_T1_2_1
#16  ch-cha_processed  SW  SW_OUT
#17  ch-cha_processed  SW  SW_OUT_CORRECTED_SETTO_0_T1_2_1
#18  ch-cha_processed  SW  SW_OUT_CORRECTED_T1_2_1
#19  ch-cha_processed  SW  SW_OUT_T1_2_1
Found 19 fields in measurement SW of bucket ch-cha_processed.
========================================
========================================
Fields in measurement PA of bucket ch-cha_processed:
#1  ch-cha_processed  PA  CUSTOM_AIR_P_MEAN
#2  ch-cha_processed  PA  PA
#3  ch-cha_processed  PA  PA_1_1_1
#4  ch-cha_processed  PA  PA_EP
#5  ch-cha_processed  PA  PA_ERA
#6  ch-cha_processed  PA  PA_F
#7  ch-cha_processed  PA  PA_F_QC
#8  ch-cha_processed  PA  PA_GF1_0.9_1
#9  ch-cha_processed  PA  PA_SOURCE
Found 9 fields in measurement PA of bucket ch-cha_processed.
========================================
CPU times: total: 2.23 s
Wall time: 3.16 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_simple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LW_IN_T1_2_1</th>
      <th>PA_GF1_0.9_1</th>
      <th>PPFD_IN_T1_2_2</th>
      <th>RH_T1_2_1</th>
      <th>SW_IN_T1_2_1</th>
      <th>TA_T1_2_1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-01-01 00:30:00</th>
      <td>327.413890</td>
      <td>965.804617</td>
      <td>0.0</td>
      <td>96.860653</td>
      <td>0.0</td>
      <td>2.004806</td>
    </tr>
    <tr>
      <th>2024-01-01 01:00:00</th>
      <td>326.428353</td>
      <td>965.977447</td>
      <td>0.0</td>
      <td>97.769545</td>
      <td>0.0</td>
      <td>1.458978</td>
    </tr>
    <tr>
      <th>2024-01-01 01:30:00</th>
      <td>323.743830</td>
      <td>965.748550</td>
      <td>0.0</td>
      <td>99.497774</td>
      <td>0.0</td>
      <td>0.816056</td>
    </tr>
    <tr>
      <th>2024-01-01 02:00:00</th>
      <td>321.212440</td>
      <td>965.525673</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-0.043878</td>
    </tr>
    <tr>
      <th>2024-01-01 02:30:00</th>
      <td>318.915697</td>
      <td>965.454533</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-0.844900</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>304.613900</td>
      <td>983.370890</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-1.919472</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>303.039890</td>
      <td>983.052160</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.104678</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>302.093633</td>
      <td>982.851140</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.089444</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>302.217307</td>
      <td>982.896827</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.355761</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>298.392973</td>
      <td>982.856613</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.578839</td>
    </tr>
  </tbody>
</table>
<p>17555 rows × 6 columns</p>
</div></div></div>
</div>
</br></section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="adjust-units-if-needed">
<h1><strong>Adjust units</strong> (if needed)<a class="headerlink" href="#adjust-units-if-needed" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Units for PA from meteoscreening_diive are given in mbar (hPa), but are needed in kPa</span>
<span class="n">data_simple</span><span class="p">[</span><span class="s1">&#39;PA_GF1_0.9_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple</span><span class="p">[</span><span class="s1">&#39;PA_GF1_0.9_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">data_simple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LW_IN_T1_2_1</th>
      <th>PA_GF1_0.9_1</th>
      <th>PPFD_IN_T1_2_2</th>
      <th>RH_T1_2_1</th>
      <th>SW_IN_T1_2_1</th>
      <th>TA_T1_2_1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-01-01 00:30:00</th>
      <td>327.413890</td>
      <td>96.580462</td>
      <td>0.0</td>
      <td>96.860653</td>
      <td>0.0</td>
      <td>2.004806</td>
    </tr>
    <tr>
      <th>2024-01-01 01:00:00</th>
      <td>326.428353</td>
      <td>96.597745</td>
      <td>0.0</td>
      <td>97.769545</td>
      <td>0.0</td>
      <td>1.458978</td>
    </tr>
    <tr>
      <th>2024-01-01 01:30:00</th>
      <td>323.743830</td>
      <td>96.574855</td>
      <td>0.0</td>
      <td>99.497774</td>
      <td>0.0</td>
      <td>0.816056</td>
    </tr>
    <tr>
      <th>2024-01-01 02:00:00</th>
      <td>321.212440</td>
      <td>96.552567</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-0.043878</td>
    </tr>
    <tr>
      <th>2024-01-01 02:30:00</th>
      <td>318.915697</td>
      <td>96.545453</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-0.844900</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>304.613900</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-1.919472</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>303.039890</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.104678</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>302.093633</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.089444</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>302.217307</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.355761</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>298.392973</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.578839</td>
    </tr>
  </tbody>
</table>
<p>17555 rows × 6 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="rename-variables-for-merging-and-for-use-in-eddypro">
<h1><strong>Rename variables for merging and for use in EddyPro</strong><a class="headerlink" href="#rename-variables-for-merging-and-for-use-in-eddypro" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;LW_IN_F&#39;</span><span class="p">:</span> <span class="s1">&#39;Lwin_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PPFD_IN&#39;</span><span class="p">:</span> <span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RH&#39;</span><span class="p">:</span> <span class="s1">&#39;RH_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SW_IN_F&#39;</span><span class="p">:</span> <span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TA_F&#39;</span><span class="p">:</span> <span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PA_F&#39;</span><span class="p">:</span> <span class="s1">&#39;Pa_1_1_1&#39;</span>
<span class="p">}</span>
<span class="n">data_simple_fluxnet</span> <span class="o">=</span> <span class="n">data_simple_fluxnet</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">renaming_dict</span><span class="p">)</span>
<span class="n">data_simple_fluxnet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lwin_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>PPFD_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>331.462</td>
      <td>98.160</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.241</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>331.462</td>
      <td>98.163</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.273</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>330.270</td>
      <td>98.167</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.305</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>330.270</td>
      <td>98.173</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.284</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>323.555</td>
      <td>98.180</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.264</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2023-12-31 22:00:00</th>
      <td>327.407</td>
      <td>96.497</td>
      <td>0.0</td>
      <td>99.5571</td>
      <td>0.0</td>
      <td>1.541</td>
    </tr>
    <tr>
      <th>2023-12-31 22:30:00</th>
      <td>327.958</td>
      <td>96.505</td>
      <td>0.0</td>
      <td>98.9703</td>
      <td>0.0</td>
      <td>2.052</td>
    </tr>
    <tr>
      <th>2023-12-31 23:00:00</th>
      <td>328.606</td>
      <td>96.526</td>
      <td>0.0</td>
      <td>97.6652</td>
      <td>0.0</td>
      <td>2.223</td>
    </tr>
    <tr>
      <th>2023-12-31 23:30:00</th>
      <td>328.278</td>
      <td>96.553</td>
      <td>0.0</td>
      <td>97.2181</td>
      <td>0.0</td>
      <td>2.207</td>
    </tr>
    <tr>
      <th>2024-01-01 00:00:00</th>
      <td>328.592</td>
      <td>96.569</td>
      <td>0.0</td>
      <td>96.6339</td>
      <td>0.0</td>
      <td>2.299</td>
    </tr>
  </tbody>
</table>
<p>333072 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;LW_IN_T1_2_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Lwin_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PPFD_IN_T1_2_2&#39;</span><span class="p">:</span> <span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RH_T1_2_1&#39;</span><span class="p">:</span> <span class="s1">&#39;RH_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SW_IN_T1_2_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TA_T1_2_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PA_GF1_0.9_1&#39;</span><span class="p">:</span> <span class="s1">&#39;Pa_1_1_1&#39;</span>
<span class="p">}</span>
<span class="n">data_simple</span> <span class="o">=</span> <span class="n">data_simple</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">renaming_dict</span><span class="p">)</span>
<span class="n">data_simple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lwin_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>PPFD_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-01-01 00:30:00</th>
      <td>327.413890</td>
      <td>96.580462</td>
      <td>0.0</td>
      <td>96.860653</td>
      <td>0.0</td>
      <td>2.004806</td>
    </tr>
    <tr>
      <th>2024-01-01 01:00:00</th>
      <td>326.428353</td>
      <td>96.597745</td>
      <td>0.0</td>
      <td>97.769545</td>
      <td>0.0</td>
      <td>1.458978</td>
    </tr>
    <tr>
      <th>2024-01-01 01:30:00</th>
      <td>323.743830</td>
      <td>96.574855</td>
      <td>0.0</td>
      <td>99.497774</td>
      <td>0.0</td>
      <td>0.816056</td>
    </tr>
    <tr>
      <th>2024-01-01 02:00:00</th>
      <td>321.212440</td>
      <td>96.552567</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-0.043878</td>
    </tr>
    <tr>
      <th>2024-01-01 02:30:00</th>
      <td>318.915697</td>
      <td>96.545453</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-0.844900</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>304.613900</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-1.919472</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>303.039890</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.104678</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>302.093633</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.089444</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>302.217307</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.355761</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>298.392973</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>99.997990</td>
      <td>0.0</td>
      <td>-2.578839</td>
    </tr>
  </tbody>
</table>
<p>17555 rows × 6 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="merge-data">
<h1><strong>Merge data</strong><a class="headerlink" href="#merge-data" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge data on index</span>
<span class="n">data_simple_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_simple_fluxnet</span><span class="p">,</span> <span class="n">data_simple</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data_simple_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lwin_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>PPFD_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>331.462000</td>
      <td>98.160000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.241000</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>331.462000</td>
      <td>98.163000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.273000</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>330.270000</td>
      <td>98.167000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.305000</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>330.270000</td>
      <td>98.173000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.284000</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>323.555000</td>
      <td>98.180000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.264000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>304.613900</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-1.919472</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>303.039890</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.104678</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>302.093633</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.089444</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>302.217307</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.355761</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>298.392973</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.578839</td>
    </tr>
  </tbody>
</table>
<p>350627 rows × 6 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="sanitize-timestamp">
<h1><strong>Sanitize timestamp</strong><a class="headerlink" href="#sanitize-timestamp" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_simple_merged</span> <span class="o">=</span> <span class="n">TimestampSanitizer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_simple_merged</span><span class="p">,</span> <span class="n">output_middle_timestamp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">data_simple_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lwin_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>PPFD_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>331.462000</td>
      <td>98.160000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.241000</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>331.462000</td>
      <td>98.163000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.273000</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>330.270000</td>
      <td>98.167000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.305000</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>330.270000</td>
      <td>98.173000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.284000</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>323.555000</td>
      <td>98.180000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2.264000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>304.613900</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-1.919472</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>303.039890</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.104678</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>302.093633</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.089444</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>302.217307</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.355761</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>298.392973</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>99.99799</td>
      <td>0.0</td>
      <td>-2.578839</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 6 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="gap-filling">
<h1><strong>Gap-filling</strong><a class="headerlink" href="#gap-filling" title="Link to this heading">#</a></h1>
<section id="rg">
<h2>Rg<a class="headerlink" href="#rg" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[[</span><span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;SW_IN_POT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">potrad</span><span class="p">(</span><span class="n">timestamp_index</span><span class="o">=</span><span class="n">_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                          <span class="n">lat</span><span class="o">=</span><span class="mf">47.210227</span><span class="p">,</span>  <span class="c1"># CH-CHA</span>
                          <span class="n">lon</span><span class="o">=</span><span class="mf">8.410645</span><span class="p">,</span>  <span class="c1"># CH-CHA</span>
                          <span class="n">utc_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rg_1_1_1</th>
      <th>SW_IN_POT</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span> <span class="o">=</span> <span class="n">XGBoostTS</span><span class="p">(</span>
    <span class="n">input_df</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
    <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">,</span>
    <span class="n">perm_n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">include_timestamp_as_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_continuous_record_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adding new data columns ...
++ Added new columns with timestamp info: [&#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;] 
++ Added new column .RECORDNUMBER with record numbers from 1 to 350640.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span><span class="o">.</span><span class="n">trainmodel</span><span class="p">(</span><span class="n">showplot_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showplot_importance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xgb</span><span class="o">.</span><span class="n">report_traintest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training final model ...
&gt;&gt;&gt; Training model &lt;class &#39;xgboost.sklearn.XGBRegressor&#39;&gt; based on data between 2005-01-01 01:00:00 and 2024-12-31 23:30:00 ...
&gt;&gt;&gt; Fitting model to training data ...
[0]	validation_0-rmse:183.75292	validation_1-rmse:183.16999
[1]	validation_0-rmse:152.93842	validation_1-rmse:152.62247
[2]	validation_0-rmse:135.13296	validation_1-rmse:135.06905
[3]	validation_0-rmse:125.27272	validation_1-rmse:125.35587
[4]	validation_0-rmse:119.91777	validation_1-rmse:120.17504
[5]	validation_0-rmse:117.00472	validation_1-rmse:117.40945
[6]	validation_0-rmse:115.48635	validation_1-rmse:116.00856
[7]	validation_0-rmse:114.57194	validation_1-rmse:115.20874
[8]	validation_0-rmse:113.88631	validation_1-rmse:114.60993
[9]	validation_0-rmse:113.37794	validation_1-rmse:114.20044
[10]	validation_0-rmse:113.05250	validation_1-rmse:113.92897
[11]	validation_0-rmse:112.71970	validation_1-rmse:113.61157
[12]	validation_0-rmse:112.43131	validation_1-rmse:113.35489
[13]	validation_0-rmse:111.81164	validation_1-rmse:112.82401
[14]	validation_0-rmse:111.37424	validation_1-rmse:112.47451
[15]	validation_0-rmse:111.19027	validation_1-rmse:112.28852
[16]	validation_0-rmse:110.73796	validation_1-rmse:111.93092
[17]	validation_0-rmse:110.29166	validation_1-rmse:111.56632
[18]	validation_0-rmse:109.92448	validation_1-rmse:111.24863
[19]	validation_0-rmse:109.74160	validation_1-rmse:111.15914
[20]	validation_0-rmse:109.65814	validation_1-rmse:111.08033
[21]	validation_0-rmse:109.29123	validation_1-rmse:110.78185
[22]	validation_0-rmse:109.15780	validation_1-rmse:110.68031
[23]	validation_0-rmse:108.91087	validation_1-rmse:110.45451
[24]	validation_0-rmse:108.50324	validation_1-rmse:110.07036
[25]	validation_0-rmse:108.36490	validation_1-rmse:110.00710
[26]	validation_0-rmse:108.05602	validation_1-rmse:109.76652
[27]	validation_0-rmse:107.58396	validation_1-rmse:109.33234
[28]	validation_0-rmse:107.36600	validation_1-rmse:109.17413
[29]	validation_0-rmse:107.25675	validation_1-rmse:109.09014
[30]	validation_0-rmse:107.02539	validation_1-rmse:108.87486
[31]	validation_0-rmse:106.75260	validation_1-rmse:108.60570
[32]	validation_0-rmse:106.45537	validation_1-rmse:108.34428
[33]	validation_0-rmse:106.33108	validation_1-rmse:108.29114
[34]	validation_0-rmse:106.11909	validation_1-rmse:108.10314
[35]	validation_0-rmse:106.01196	validation_1-rmse:108.02125
[36]	validation_0-rmse:105.91271	validation_1-rmse:107.93605
[37]	validation_0-rmse:105.81613	validation_1-rmse:107.86344
[38]	validation_0-rmse:105.55554	validation_1-rmse:107.64572
[39]	validation_0-rmse:105.33603	validation_1-rmse:107.48140
[40]	validation_0-rmse:105.03672	validation_1-rmse:107.22381
[41]	validation_0-rmse:104.80858	validation_1-rmse:106.98975
[42]	validation_0-rmse:104.65173	validation_1-rmse:106.84706
[43]	validation_0-rmse:104.30548	validation_1-rmse:106.53592
[44]	validation_0-rmse:104.14173	validation_1-rmse:106.39714
[45]	validation_0-rmse:103.91796	validation_1-rmse:106.23025
[46]	validation_0-rmse:103.79919	validation_1-rmse:106.13715
[47]	validation_0-rmse:103.69740	validation_1-rmse:106.06387
[48]	validation_0-rmse:103.56428	validation_1-rmse:105.96784
[49]	validation_0-rmse:103.36386	validation_1-rmse:105.80991
[50]	validation_0-rmse:103.12511	validation_1-rmse:105.56519
[51]	validation_0-rmse:102.86115	validation_1-rmse:105.32897
[52]	validation_0-rmse:102.73295	validation_1-rmse:105.28812
[53]	validation_0-rmse:102.61857	validation_1-rmse:105.20136
[54]	validation_0-rmse:102.57268	validation_1-rmse:105.16020
[55]	validation_0-rmse:102.50886	validation_1-rmse:105.15212
[56]	validation_0-rmse:102.23091	validation_1-rmse:104.91125
[57]	validation_0-rmse:102.07520	validation_1-rmse:104.81481
[58]	validation_0-rmse:101.92530	validation_1-rmse:104.74512
[59]	validation_0-rmse:101.75566	validation_1-rmse:104.63979
[60]	validation_0-rmse:101.68285	validation_1-rmse:104.58392
[61]	validation_0-rmse:101.64225	validation_1-rmse:104.53616
[62]	validation_0-rmse:101.58900	validation_1-rmse:104.50428
[63]	validation_0-rmse:101.33753	validation_1-rmse:104.29136
[64]	validation_0-rmse:101.04760	validation_1-rmse:104.05781
[65]	validation_0-rmse:100.88109	validation_1-rmse:103.91500
[66]	validation_0-rmse:100.78127	validation_1-rmse:103.83648
[67]	validation_0-rmse:100.69022	validation_1-rmse:103.78292
[68]	validation_0-rmse:100.52411	validation_1-rmse:103.66799
[69]	validation_0-rmse:100.47020	validation_1-rmse:103.61451
[70]	validation_0-rmse:100.38444	validation_1-rmse:103.55316
[71]	validation_0-rmse:100.25027	validation_1-rmse:103.49797
[72]	validation_0-rmse:99.98989	validation_1-rmse:103.26026
[73]	validation_0-rmse:99.88763	validation_1-rmse:103.21741
[74]	validation_0-rmse:99.80818	validation_1-rmse:103.18210
[75]	validation_0-rmse:99.67478	validation_1-rmse:103.07951
[76]	validation_0-rmse:99.56186	validation_1-rmse:102.97520
[77]	validation_0-rmse:99.38749	validation_1-rmse:102.80131
[78]	validation_0-rmse:99.27733	validation_1-rmse:102.78666
[79]	validation_0-rmse:99.17294	validation_1-rmse:102.69789
[80]	validation_0-rmse:99.04212	validation_1-rmse:102.60523
[81]	validation_0-rmse:98.82611	validation_1-rmse:102.42420
[82]	validation_0-rmse:98.76398	validation_1-rmse:102.38423
[83]	validation_0-rmse:98.69068	validation_1-rmse:102.32891
[84]	validation_0-rmse:98.53196	validation_1-rmse:102.21236
[85]	validation_0-rmse:98.37715	validation_1-rmse:102.10130
[86]	validation_0-rmse:98.22514	validation_1-rmse:102.02324
[87]	validation_0-rmse:98.04228	validation_1-rmse:101.87709
[88]	validation_0-rmse:97.92259	validation_1-rmse:101.77156
[89]	validation_0-rmse:97.84145	validation_1-rmse:101.72492
[90]	validation_0-rmse:97.59704	validation_1-rmse:101.51720
[91]	validation_0-rmse:97.52540	validation_1-rmse:101.49181
[92]	validation_0-rmse:97.48081	validation_1-rmse:101.45906
[93]	validation_0-rmse:97.42246	validation_1-rmse:101.41291
[94]	validation_0-rmse:97.35756	validation_1-rmse:101.37864
[95]	validation_0-rmse:97.28747	validation_1-rmse:101.32706
[96]	validation_0-rmse:97.22344	validation_1-rmse:101.28382
[97]	validation_0-rmse:97.15985	validation_1-rmse:101.25548
[98]	validation_0-rmse:97.00743	validation_1-rmse:101.13139
[99]	validation_0-rmse:96.91147	validation_1-rmse:101.04339
[100]	validation_0-rmse:96.74649	validation_1-rmse:100.88304
[101]	validation_0-rmse:96.63676	validation_1-rmse:100.82690
[102]	validation_0-rmse:96.55418	validation_1-rmse:100.81698
[103]	validation_0-rmse:96.38986	validation_1-rmse:100.68773
[104]	validation_0-rmse:96.23650	validation_1-rmse:100.52368
[105]	validation_0-rmse:96.15943	validation_1-rmse:100.49630
[106]	validation_0-rmse:96.02612	validation_1-rmse:100.39843
[107]	validation_0-rmse:95.91782	validation_1-rmse:100.29836
[108]	validation_0-rmse:95.87053	validation_1-rmse:100.26386
[109]	validation_0-rmse:95.73354	validation_1-rmse:100.15517
[110]	validation_0-rmse:95.58366	validation_1-rmse:100.03017
[111]	validation_0-rmse:95.42814	validation_1-rmse:99.90039
[112]	validation_0-rmse:95.37615	validation_1-rmse:99.85846
[113]	validation_0-rmse:95.20454	validation_1-rmse:99.69334
[114]	validation_0-rmse:95.07159	validation_1-rmse:99.59389
[115]	validation_0-rmse:94.95710	validation_1-rmse:99.51757
[116]	validation_0-rmse:94.86013	validation_1-rmse:99.40632
[117]	validation_0-rmse:94.79444	validation_1-rmse:99.35242
[118]	validation_0-rmse:94.74220	validation_1-rmse:99.32605
[119]	validation_0-rmse:94.68761	validation_1-rmse:99.29004
[120]	validation_0-rmse:94.64429	validation_1-rmse:99.25376
[121]	validation_0-rmse:94.50661	validation_1-rmse:99.14818
[122]	validation_0-rmse:94.38033	validation_1-rmse:99.11978
[123]	validation_0-rmse:94.29265	validation_1-rmse:99.07222
[124]	validation_0-rmse:94.15974	validation_1-rmse:98.97070
[125]	validation_0-rmse:94.13827	validation_1-rmse:98.94378
[126]	validation_0-rmse:94.05048	validation_1-rmse:98.86918
[127]	validation_0-rmse:93.97042	validation_1-rmse:98.79664
[128]	validation_0-rmse:93.95004	validation_1-rmse:98.78619
[129]	validation_0-rmse:93.91074	validation_1-rmse:98.74974
[130]	validation_0-rmse:93.89652	validation_1-rmse:98.73712
[131]	validation_0-rmse:93.80051	validation_1-rmse:98.66646
[132]	validation_0-rmse:93.75370	validation_1-rmse:98.66542
[133]	validation_0-rmse:93.62928	validation_1-rmse:98.54428
[134]	validation_0-rmse:93.42308	validation_1-rmse:98.42298
[135]	validation_0-rmse:93.34163	validation_1-rmse:98.36064
[136]	validation_0-rmse:93.27171	validation_1-rmse:98.35743
[137]	validation_0-rmse:93.15687	validation_1-rmse:98.30042
[138]	validation_0-rmse:93.10685	validation_1-rmse:98.29400
[139]	validation_0-rmse:92.99683	validation_1-rmse:98.19098
[140]	validation_0-rmse:92.98223	validation_1-rmse:98.18417
[141]	validation_0-rmse:92.84618	validation_1-rmse:98.13816
[142]	validation_0-rmse:92.72882	validation_1-rmse:98.07434
[143]	validation_0-rmse:92.65041	validation_1-rmse:98.01935
[144]	validation_0-rmse:92.51798	validation_1-rmse:97.92857
[145]	validation_0-rmse:92.44797	validation_1-rmse:97.87875
[146]	validation_0-rmse:92.29211	validation_1-rmse:97.76650
[147]	validation_0-rmse:92.18093	validation_1-rmse:97.68763
[148]	validation_0-rmse:92.12958	validation_1-rmse:97.65058
[149]	validation_0-rmse:92.06277	validation_1-rmse:97.61017
[150]	validation_0-rmse:91.99544	validation_1-rmse:97.56271
[151]	validation_0-rmse:91.91280	validation_1-rmse:97.53698
[152]	validation_0-rmse:91.86873	validation_1-rmse:97.49736
[153]	validation_0-rmse:91.74542	validation_1-rmse:97.43912
[154]	validation_0-rmse:91.64615	validation_1-rmse:97.40878
[155]	validation_0-rmse:91.56750	validation_1-rmse:97.36891
[156]	validation_0-rmse:91.49981	validation_1-rmse:97.30068
[157]	validation_0-rmse:91.46043	validation_1-rmse:97.25459
[158]	validation_0-rmse:91.33357	validation_1-rmse:97.18940
[159]	validation_0-rmse:91.21764	validation_1-rmse:97.09020
[160]	validation_0-rmse:91.19925	validation_1-rmse:97.07417
[161]	validation_0-rmse:91.15693	validation_1-rmse:97.04737
[162]	validation_0-rmse:91.06647	validation_1-rmse:96.96040
[163]	validation_0-rmse:91.00595	validation_1-rmse:96.93426
[164]	validation_0-rmse:90.88919	validation_1-rmse:96.84610
[165]	validation_0-rmse:90.79287	validation_1-rmse:96.76699
[166]	validation_0-rmse:90.70103	validation_1-rmse:96.70401
[167]	validation_0-rmse:90.57737	validation_1-rmse:96.58750
[168]	validation_0-rmse:90.54869	validation_1-rmse:96.56070
[169]	validation_0-rmse:90.50279	validation_1-rmse:96.57142
[170]	validation_0-rmse:90.48623	validation_1-rmse:96.55830
[171]	validation_0-rmse:90.43009	validation_1-rmse:96.51783
[172]	validation_0-rmse:90.33555	validation_1-rmse:96.45921
[173]	validation_0-rmse:90.27860	validation_1-rmse:96.42530
[174]	validation_0-rmse:90.26488	validation_1-rmse:96.41591
[175]	validation_0-rmse:90.19136	validation_1-rmse:96.35582
[176]	validation_0-rmse:90.13684	validation_1-rmse:96.30855
[177]	validation_0-rmse:90.03208	validation_1-rmse:96.22057
[178]	validation_0-rmse:89.98993	validation_1-rmse:96.20847
[179]	validation_0-rmse:89.95245	validation_1-rmse:96.18885
[180]	validation_0-rmse:89.89613	validation_1-rmse:96.14093
[181]	validation_0-rmse:89.79954	validation_1-rmse:96.06453
[182]	validation_0-rmse:89.78557	validation_1-rmse:96.06479
[183]	validation_0-rmse:89.71650	validation_1-rmse:96.04564
[184]	validation_0-rmse:89.68194	validation_1-rmse:96.02773
[185]	validation_0-rmse:89.61399	validation_1-rmse:95.98259
[186]	validation_0-rmse:89.55050	validation_1-rmse:95.94936
[187]	validation_0-rmse:89.51695	validation_1-rmse:95.94189
[188]	validation_0-rmse:89.45276	validation_1-rmse:95.89789
[189]	validation_0-rmse:89.41518	validation_1-rmse:95.89750
[190]	validation_0-rmse:89.37111	validation_1-rmse:95.87514
[191]	validation_0-rmse:89.30243	validation_1-rmse:95.82758
[192]	validation_0-rmse:89.26728	validation_1-rmse:95.79574
[193]	validation_0-rmse:89.20280	validation_1-rmse:95.73571
[194]	validation_0-rmse:89.11484	validation_1-rmse:95.67545
[195]	validation_0-rmse:89.02923	validation_1-rmse:95.62946
[196]	validation_0-rmse:88.96653	validation_1-rmse:95.61338
[197]	validation_0-rmse:88.87893	validation_1-rmse:95.53875
[198]	validation_0-rmse:88.80827	validation_1-rmse:95.51087
[199]	validation_0-rmse:88.71587	validation_1-rmse:95.46060
[200]	validation_0-rmse:88.61024	validation_1-rmse:95.37362
[201]	validation_0-rmse:88.48330	validation_1-rmse:95.24968
[202]	validation_0-rmse:88.42440	validation_1-rmse:95.22817
[203]	validation_0-rmse:88.39912	validation_1-rmse:95.21561
[204]	validation_0-rmse:88.37653	validation_1-rmse:95.20225
[205]	validation_0-rmse:88.28097	validation_1-rmse:95.09821
[206]	validation_0-rmse:88.23790	validation_1-rmse:95.08640
[207]	validation_0-rmse:88.20434	validation_1-rmse:95.06255
[208]	validation_0-rmse:88.16093	validation_1-rmse:95.04484
[209]	validation_0-rmse:88.12285	validation_1-rmse:95.01287
[210]	validation_0-rmse:88.02194	validation_1-rmse:94.96573
[211]	validation_0-rmse:87.99898	validation_1-rmse:94.94881
[212]	validation_0-rmse:87.88740	validation_1-rmse:94.89054
[213]	validation_0-rmse:87.85381	validation_1-rmse:94.89634
[214]	validation_0-rmse:87.71939	validation_1-rmse:94.79709
[215]	validation_0-rmse:87.68131	validation_1-rmse:94.77595
[216]	validation_0-rmse:87.61794	validation_1-rmse:94.73985
[217]	validation_0-rmse:87.55245	validation_1-rmse:94.69680
[218]	validation_0-rmse:87.51362	validation_1-rmse:94.67170
[219]	validation_0-rmse:87.50403	validation_1-rmse:94.66800
[220]	validation_0-rmse:87.44388	validation_1-rmse:94.62990
[221]	validation_0-rmse:87.41714	validation_1-rmse:94.60903
[222]	validation_0-rmse:87.36599	validation_1-rmse:94.59482
[223]	validation_0-rmse:87.34389	validation_1-rmse:94.56873
[224]	validation_0-rmse:87.26653	validation_1-rmse:94.50641
[225]	validation_0-rmse:87.14245	validation_1-rmse:94.45020
[226]	validation_0-rmse:87.09581	validation_1-rmse:94.42507
[227]	validation_0-rmse:87.06907	validation_1-rmse:94.41177
[228]	validation_0-rmse:87.01466	validation_1-rmse:94.36986
[229]	validation_0-rmse:86.98665	validation_1-rmse:94.36118
[230]	validation_0-rmse:86.95177	validation_1-rmse:94.34456
[231]	validation_0-rmse:86.89668	validation_1-rmse:94.30929
[232]	validation_0-rmse:86.80800	validation_1-rmse:94.26041
[233]	validation_0-rmse:86.78214	validation_1-rmse:94.24457
[234]	validation_0-rmse:86.71536	validation_1-rmse:94.18433
[235]	validation_0-rmse:86.69525	validation_1-rmse:94.17838
[236]	validation_0-rmse:86.66089	validation_1-rmse:94.15702
[237]	validation_0-rmse:86.63365	validation_1-rmse:94.13948
[238]	validation_0-rmse:86.59509	validation_1-rmse:94.11745
[239]	validation_0-rmse:86.50153	validation_1-rmse:94.07036
[240]	validation_0-rmse:86.40177	validation_1-rmse:94.03442
[241]	validation_0-rmse:86.37548	validation_1-rmse:94.02350
[242]	validation_0-rmse:86.35512	validation_1-rmse:94.00979
[243]	validation_0-rmse:86.30331	validation_1-rmse:93.96456
[244]	validation_0-rmse:86.19556	validation_1-rmse:93.89993
[245]	validation_0-rmse:86.16049	validation_1-rmse:93.88660
[246]	validation_0-rmse:86.08436	validation_1-rmse:93.85007
[247]	validation_0-rmse:86.07515	validation_1-rmse:93.84921
[248]	validation_0-rmse:86.01781	validation_1-rmse:93.81799
[249]	validation_0-rmse:86.01026	validation_1-rmse:93.81742
[250]	validation_0-rmse:85.96634	validation_1-rmse:93.79312
[251]	validation_0-rmse:85.91118	validation_1-rmse:93.76943
[252]	validation_0-rmse:85.84291	validation_1-rmse:93.72118
[253]	validation_0-rmse:85.80034	validation_1-rmse:93.68619
[254]	validation_0-rmse:85.79390	validation_1-rmse:93.68296
[255]	validation_0-rmse:85.72086	validation_1-rmse:93.63475
[256]	validation_0-rmse:85.64287	validation_1-rmse:93.57902
[257]	validation_0-rmse:85.60520	validation_1-rmse:93.55042
[258]	validation_0-rmse:85.51767	validation_1-rmse:93.45863
[259]	validation_0-rmse:85.45363	validation_1-rmse:93.43757
[260]	validation_0-rmse:85.39291	validation_1-rmse:93.41222
[261]	validation_0-rmse:85.33920	validation_1-rmse:93.38098
[262]	validation_0-rmse:85.26595	validation_1-rmse:93.34227
[263]	validation_0-rmse:85.20059	validation_1-rmse:93.33620
[264]	validation_0-rmse:85.15362	validation_1-rmse:93.32631
[265]	validation_0-rmse:85.07865	validation_1-rmse:93.26674
[266]	validation_0-rmse:85.04864	validation_1-rmse:93.23468
[267]	validation_0-rmse:85.00696	validation_1-rmse:93.23282
[268]	validation_0-rmse:84.98111	validation_1-rmse:93.21373
[269]	validation_0-rmse:84.97384	validation_1-rmse:93.21027
[270]	validation_0-rmse:84.94965	validation_1-rmse:93.19310
[271]	validation_0-rmse:84.94086	validation_1-rmse:93.19179
[272]	validation_0-rmse:84.86562	validation_1-rmse:93.14847
[273]	validation_0-rmse:84.81207	validation_1-rmse:93.11866
[274]	validation_0-rmse:84.76796	validation_1-rmse:93.08163
[275]	validation_0-rmse:84.73104	validation_1-rmse:93.06599
[276]	validation_0-rmse:84.66073	validation_1-rmse:93.02352
[277]	validation_0-rmse:84.62470	validation_1-rmse:93.00341
[278]	validation_0-rmse:84.60012	validation_1-rmse:92.98712
[279]	validation_0-rmse:84.55668	validation_1-rmse:92.94451
[280]	validation_0-rmse:84.54557	validation_1-rmse:92.93853
[281]	validation_0-rmse:84.50411	validation_1-rmse:92.90377
[282]	validation_0-rmse:84.42395	validation_1-rmse:92.85540
[283]	validation_0-rmse:84.35252	validation_1-rmse:92.82126
[284]	validation_0-rmse:84.28751	validation_1-rmse:92.77919
[285]	validation_0-rmse:84.25974	validation_1-rmse:92.76425
[286]	validation_0-rmse:84.22851	validation_1-rmse:92.76103
[287]	validation_0-rmse:84.14970	validation_1-rmse:92.69054
[288]	validation_0-rmse:84.12372	validation_1-rmse:92.67325
[289]	validation_0-rmse:84.06755	validation_1-rmse:92.66498
[290]	validation_0-rmse:84.02032	validation_1-rmse:92.62756
[291]	validation_0-rmse:83.92791	validation_1-rmse:92.57028
[292]	validation_0-rmse:83.92212	validation_1-rmse:92.56597
[293]	validation_0-rmse:83.91517	validation_1-rmse:92.57076
[294]	validation_0-rmse:83.87742	validation_1-rmse:92.55532
[295]	validation_0-rmse:83.83901	validation_1-rmse:92.53371
[296]	validation_0-rmse:83.82928	validation_1-rmse:92.52532
[297]	validation_0-rmse:83.79274	validation_1-rmse:92.49913
[298]	validation_0-rmse:83.74376	validation_1-rmse:92.46288
[299]	validation_0-rmse:83.69952	validation_1-rmse:92.46988
[300]	validation_0-rmse:83.66992	validation_1-rmse:92.48086
[301]	validation_0-rmse:83.65331	validation_1-rmse:92.47518
[302]	validation_0-rmse:83.59632	validation_1-rmse:92.44454
[303]	validation_0-rmse:83.53805	validation_1-rmse:92.39058
[304]	validation_0-rmse:83.52199	validation_1-rmse:92.38228
[305]	validation_0-rmse:83.47087	validation_1-rmse:92.34571
[306]	validation_0-rmse:83.45441	validation_1-rmse:92.33348
[307]	validation_0-rmse:83.40599	validation_1-rmse:92.30646
[308]	validation_0-rmse:83.31434	validation_1-rmse:92.20699
[309]	validation_0-rmse:83.26388	validation_1-rmse:92.17139
[310]	validation_0-rmse:83.21592	validation_1-rmse:92.13864
[311]	validation_0-rmse:83.15440	validation_1-rmse:92.08852
[312]	validation_0-rmse:83.10531	validation_1-rmse:92.06298
[313]	validation_0-rmse:83.07005	validation_1-rmse:92.04593
[314]	validation_0-rmse:83.02271	validation_1-rmse:92.05248
[315]	validation_0-rmse:83.00092	validation_1-rmse:92.04972
[316]	validation_0-rmse:82.97565	validation_1-rmse:92.04330
[317]	validation_0-rmse:82.96262	validation_1-rmse:92.04031
[318]	validation_0-rmse:82.93870	validation_1-rmse:92.03814
[319]	validation_0-rmse:82.86112	validation_1-rmse:91.98779
[320]	validation_0-rmse:82.75143	validation_1-rmse:91.90713
[321]	validation_0-rmse:82.66721	validation_1-rmse:91.84480
[322]	validation_0-rmse:82.59830	validation_1-rmse:91.77681
[323]	validation_0-rmse:82.54220	validation_1-rmse:91.72695
[324]	validation_0-rmse:82.47994	validation_1-rmse:91.70934
[325]	validation_0-rmse:82.44121	validation_1-rmse:91.71395
[326]	validation_0-rmse:82.39060	validation_1-rmse:91.68330
[327]	validation_0-rmse:82.36562	validation_1-rmse:91.66896
[328]	validation_0-rmse:82.34450	validation_1-rmse:91.65859
[329]	validation_0-rmse:82.33492	validation_1-rmse:91.64966
[330]	validation_0-rmse:82.30408	validation_1-rmse:91.65903
[331]	validation_0-rmse:82.27279	validation_1-rmse:91.64901
[332]	validation_0-rmse:82.19746	validation_1-rmse:91.60889
[333]	validation_0-rmse:82.17494	validation_1-rmse:91.60925
[334]	validation_0-rmse:82.13701	validation_1-rmse:91.60139
[335]	validation_0-rmse:82.10424	validation_1-rmse:91.57657
[336]	validation_0-rmse:82.06046	validation_1-rmse:91.55364
[337]	validation_0-rmse:82.04100	validation_1-rmse:91.54403
[338]	validation_0-rmse:82.00173	validation_1-rmse:91.51458
[339]	validation_0-rmse:81.96668	validation_1-rmse:91.48860
[340]	validation_0-rmse:81.88061	validation_1-rmse:91.37452
[341]	validation_0-rmse:81.86750	validation_1-rmse:91.36193
[342]	validation_0-rmse:81.80467	validation_1-rmse:91.34258
[343]	validation_0-rmse:81.76591	validation_1-rmse:91.31628
[344]	validation_0-rmse:81.74205	validation_1-rmse:91.31454
[345]	validation_0-rmse:81.68206	validation_1-rmse:91.26742
[346]	validation_0-rmse:81.63631	validation_1-rmse:91.23929
[347]	validation_0-rmse:81.60240	validation_1-rmse:91.20644
[348]	validation_0-rmse:81.53611	validation_1-rmse:91.15702
[349]	validation_0-rmse:81.50406	validation_1-rmse:91.16426
[350]	validation_0-rmse:81.46555	validation_1-rmse:91.15496
[351]	validation_0-rmse:81.44814	validation_1-rmse:91.16154
[352]	validation_0-rmse:81.40040	validation_1-rmse:91.15454
[353]	validation_0-rmse:81.37896	validation_1-rmse:91.13950
[354]	validation_0-rmse:81.33551	validation_1-rmse:91.13575
[355]	validation_0-rmse:81.29459	validation_1-rmse:91.12447
[356]	validation_0-rmse:81.24962	validation_1-rmse:91.09667
[357]	validation_0-rmse:81.22473	validation_1-rmse:91.07911
[358]	validation_0-rmse:81.17998	validation_1-rmse:91.07067
[359]	validation_0-rmse:81.16483	validation_1-rmse:91.06334
[360]	validation_0-rmse:81.15177	validation_1-rmse:91.05901
[361]	validation_0-rmse:81.11398	validation_1-rmse:91.04470
[362]	validation_0-rmse:81.10589	validation_1-rmse:91.03850
[363]	validation_0-rmse:81.04077	validation_1-rmse:90.98167
[364]	validation_0-rmse:81.00210	validation_1-rmse:90.95133
[365]	validation_0-rmse:80.97554	validation_1-rmse:90.95560
[366]	validation_0-rmse:80.94835	validation_1-rmse:90.94529
[367]	validation_0-rmse:80.91998	validation_1-rmse:90.92062
[368]	validation_0-rmse:80.85948	validation_1-rmse:90.88295
[369]	validation_0-rmse:80.82654	validation_1-rmse:90.87995
[370]	validation_0-rmse:80.80025	validation_1-rmse:90.87223
[371]	validation_0-rmse:80.73295	validation_1-rmse:90.82543
[372]	validation_0-rmse:80.71405	validation_1-rmse:90.82353
[373]	validation_0-rmse:80.64690	validation_1-rmse:90.77161
[374]	validation_0-rmse:80.62211	validation_1-rmse:90.76342
[375]	validation_0-rmse:80.61252	validation_1-rmse:90.75747
[376]	validation_0-rmse:80.60674	validation_1-rmse:90.75164
[377]	validation_0-rmse:80.59261	validation_1-rmse:90.74310
[378]	validation_0-rmse:80.56872	validation_1-rmse:90.72482
[379]	validation_0-rmse:80.52332	validation_1-rmse:90.68964
[380]	validation_0-rmse:80.50985	validation_1-rmse:90.68440
[381]	validation_0-rmse:80.48948	validation_1-rmse:90.66448
[382]	validation_0-rmse:80.47148	validation_1-rmse:90.65083
[383]	validation_0-rmse:80.45051	validation_1-rmse:90.64533
[384]	validation_0-rmse:80.42937	validation_1-rmse:90.63181
[385]	validation_0-rmse:80.39520	validation_1-rmse:90.62114
[386]	validation_0-rmse:80.36758	validation_1-rmse:90.60844
[387]	validation_0-rmse:80.31702	validation_1-rmse:90.58196
[388]	validation_0-rmse:80.30006	validation_1-rmse:90.56922
[389]	validation_0-rmse:80.27830	validation_1-rmse:90.56089
[390]	validation_0-rmse:80.22348	validation_1-rmse:90.52809
[391]	validation_0-rmse:80.15500	validation_1-rmse:90.46500
[392]	validation_0-rmse:80.11377	validation_1-rmse:90.42525
[393]	validation_0-rmse:80.02311	validation_1-rmse:90.36886
[394]	validation_0-rmse:79.98908	validation_1-rmse:90.35412
[395]	validation_0-rmse:79.93693	validation_1-rmse:90.35225
[396]	validation_0-rmse:79.91884	validation_1-rmse:90.35691
[397]	validation_0-rmse:79.89614	validation_1-rmse:90.35006
[398]	validation_0-rmse:79.86452	validation_1-rmse:90.34137
[399]	validation_0-rmse:79.80300	validation_1-rmse:90.31208
[400]	validation_0-rmse:79.75497	validation_1-rmse:90.28453
[401]	validation_0-rmse:79.75100	validation_1-rmse:90.28424
[402]	validation_0-rmse:79.74122	validation_1-rmse:90.27738
[403]	validation_0-rmse:79.71562	validation_1-rmse:90.26772
[404]	validation_0-rmse:79.67144	validation_1-rmse:90.25667
[405]	validation_0-rmse:79.62058	validation_1-rmse:90.20933
[406]	validation_0-rmse:79.60142	validation_1-rmse:90.18978
[407]	validation_0-rmse:79.57164	validation_1-rmse:90.18225
[408]	validation_0-rmse:79.55499	validation_1-rmse:90.16665
[409]	validation_0-rmse:79.51007	validation_1-rmse:90.14990
[410]	validation_0-rmse:79.43912	validation_1-rmse:90.10803
[411]	validation_0-rmse:79.40376	validation_1-rmse:90.11561
[412]	validation_0-rmse:79.37765	validation_1-rmse:90.14166
[413]	validation_0-rmse:79.30809	validation_1-rmse:90.10895
[414]	validation_0-rmse:79.24725	validation_1-rmse:90.05394
[415]	validation_0-rmse:79.20047	validation_1-rmse:90.03092
[416]	validation_0-rmse:79.18850	validation_1-rmse:90.02778
[417]	validation_0-rmse:79.14985	validation_1-rmse:89.99932
[418]	validation_0-rmse:79.09427	validation_1-rmse:89.96170
[419]	validation_0-rmse:79.02492	validation_1-rmse:89.91806
[420]	validation_0-rmse:78.98233	validation_1-rmse:89.93830
[421]	validation_0-rmse:78.91596	validation_1-rmse:89.92097
[422]	validation_0-rmse:78.86086	validation_1-rmse:89.86395
[423]	validation_0-rmse:78.81003	validation_1-rmse:89.84215
[424]	validation_0-rmse:78.77654	validation_1-rmse:89.81682
[425]	validation_0-rmse:78.74002	validation_1-rmse:89.80094
[426]	validation_0-rmse:78.71965	validation_1-rmse:89.79367
[427]	validation_0-rmse:78.68209	validation_1-rmse:89.77097
[428]	validation_0-rmse:78.64526	validation_1-rmse:89.73747
[429]	validation_0-rmse:78.63982	validation_1-rmse:89.73844
[430]	validation_0-rmse:78.58869	validation_1-rmse:89.71226
[431]	validation_0-rmse:78.52877	validation_1-rmse:89.66868
[432]	validation_0-rmse:78.49624	validation_1-rmse:89.66150
[433]	validation_0-rmse:78.45329	validation_1-rmse:89.62405
[434]	validation_0-rmse:78.44350	validation_1-rmse:89.61721
[435]	validation_0-rmse:78.41309	validation_1-rmse:89.60007
[436]	validation_0-rmse:78.34198	validation_1-rmse:89.55316
[437]	validation_0-rmse:78.30830	validation_1-rmse:89.53272
[438]	validation_0-rmse:78.24292	validation_1-rmse:89.46800
[439]	validation_0-rmse:78.21860	validation_1-rmse:89.45688
[440]	validation_0-rmse:78.18876	validation_1-rmse:89.44653
[441]	validation_0-rmse:78.13683	validation_1-rmse:89.40678
[442]	validation_0-rmse:78.10071	validation_1-rmse:89.37326
[443]	validation_0-rmse:78.06117	validation_1-rmse:89.35759
[444]	validation_0-rmse:78.00950	validation_1-rmse:89.34369
[445]	validation_0-rmse:77.93988	validation_1-rmse:89.29923
[446]	validation_0-rmse:77.88509	validation_1-rmse:89.28502
[447]	validation_0-rmse:77.86680	validation_1-rmse:89.28620
[448]	validation_0-rmse:77.84393	validation_1-rmse:89.27452
[449]	validation_0-rmse:77.82389	validation_1-rmse:89.26493
[450]	validation_0-rmse:77.77844	validation_1-rmse:89.24254
[451]	validation_0-rmse:77.73082	validation_1-rmse:89.21451
[452]	validation_0-rmse:77.70433	validation_1-rmse:89.22401
[453]	validation_0-rmse:77.64625	validation_1-rmse:89.20948
[454]	validation_0-rmse:77.61968	validation_1-rmse:89.20626
[455]	validation_0-rmse:77.60269	validation_1-rmse:89.19818
[456]	validation_0-rmse:77.58749	validation_1-rmse:89.19753
[457]	validation_0-rmse:77.56705	validation_1-rmse:89.18269
[458]	validation_0-rmse:77.53930	validation_1-rmse:89.16731
[459]	validation_0-rmse:77.50312	validation_1-rmse:89.16725
[460]	validation_0-rmse:77.46607	validation_1-rmse:89.14899
[461]	validation_0-rmse:77.44119	validation_1-rmse:89.15491
[462]	validation_0-rmse:77.41172	validation_1-rmse:89.15120
[463]	validation_0-rmse:77.38725	validation_1-rmse:89.13333
[464]	validation_0-rmse:77.36666	validation_1-rmse:89.11839
[465]	validation_0-rmse:77.33997	validation_1-rmse:89.09584
[466]	validation_0-rmse:77.32935	validation_1-rmse:89.09303
[467]	validation_0-rmse:77.31556	validation_1-rmse:89.09471
[468]	validation_0-rmse:77.28470	validation_1-rmse:89.07393
[469]	validation_0-rmse:77.21704	validation_1-rmse:89.02618
[470]	validation_0-rmse:77.19769	validation_1-rmse:89.01712
[471]	validation_0-rmse:77.16897	validation_1-rmse:89.00727
[472]	validation_0-rmse:77.12093	validation_1-rmse:88.98285
[473]	validation_0-rmse:77.10589	validation_1-rmse:88.97224
[474]	validation_0-rmse:77.09356	validation_1-rmse:88.99141
[475]	validation_0-rmse:77.06906	validation_1-rmse:88.98353
[476]	validation_0-rmse:77.03376	validation_1-rmse:88.97081
[477]	validation_0-rmse:77.02845	validation_1-rmse:88.96764
[478]	validation_0-rmse:76.99340	validation_1-rmse:88.95306
[479]	validation_0-rmse:76.94949	validation_1-rmse:88.92926
[480]	validation_0-rmse:76.92654	validation_1-rmse:88.93541
[481]	validation_0-rmse:76.88197	validation_1-rmse:88.90627
[482]	validation_0-rmse:76.81256	validation_1-rmse:88.86138
[483]	validation_0-rmse:76.79374	validation_1-rmse:88.87179
[484]	validation_0-rmse:76.77076	validation_1-rmse:88.87359
[485]	validation_0-rmse:76.74400	validation_1-rmse:88.86814
[486]	validation_0-rmse:76.69024	validation_1-rmse:88.83591
[487]	validation_0-rmse:76.67114	validation_1-rmse:88.82737
[488]	validation_0-rmse:76.66221	validation_1-rmse:88.82224
[489]	validation_0-rmse:76.64037	validation_1-rmse:88.82706
[490]	validation_0-rmse:76.62288	validation_1-rmse:88.82262
[491]	validation_0-rmse:76.57180	validation_1-rmse:88.78805
[492]	validation_0-rmse:76.50643	validation_1-rmse:88.78522
[493]	validation_0-rmse:76.46788	validation_1-rmse:88.78295
[494]	validation_0-rmse:76.44135	validation_1-rmse:88.78149
[495]	validation_0-rmse:76.40234	validation_1-rmse:88.77781
[496]	validation_0-rmse:76.37882	validation_1-rmse:88.77053
[497]	validation_0-rmse:76.35632	validation_1-rmse:88.75856
[498]	validation_0-rmse:76.32358	validation_1-rmse:88.75709
[499]	validation_0-rmse:76.28826	validation_1-rmse:88.73064
[500]	validation_0-rmse:76.26695	validation_1-rmse:88.71891
[501]	validation_0-rmse:76.22122	validation_1-rmse:88.69269
[502]	validation_0-rmse:76.19783	validation_1-rmse:88.68396
[503]	validation_0-rmse:76.15999	validation_1-rmse:88.66637
[504]	validation_0-rmse:76.14623	validation_1-rmse:88.65768
[505]	validation_0-rmse:76.11564	validation_1-rmse:88.65031
[506]	validation_0-rmse:76.09601	validation_1-rmse:88.63991
[507]	validation_0-rmse:76.04511	validation_1-rmse:88.61679
[508]	validation_0-rmse:76.02386	validation_1-rmse:88.60598
[509]	validation_0-rmse:76.00625	validation_1-rmse:88.60193
[510]	validation_0-rmse:75.98426	validation_1-rmse:88.59691
[511]	validation_0-rmse:75.95226	validation_1-rmse:88.58995
[512]	validation_0-rmse:75.91135	validation_1-rmse:88.58111
[513]	validation_0-rmse:75.88434	validation_1-rmse:88.56224
[514]	validation_0-rmse:75.85071	validation_1-rmse:88.53599
[515]	validation_0-rmse:75.81998	validation_1-rmse:88.52401
[516]	validation_0-rmse:75.81096	validation_1-rmse:88.51690
[517]	validation_0-rmse:75.78355	validation_1-rmse:88.50862
[518]	validation_0-rmse:75.77049	validation_1-rmse:88.51292
[519]	validation_0-rmse:75.73839	validation_1-rmse:88.50155
[520]	validation_0-rmse:75.72016	validation_1-rmse:88.49163
[521]	validation_0-rmse:75.70008	validation_1-rmse:88.48118
[522]	validation_0-rmse:75.68672	validation_1-rmse:88.48591
[523]	validation_0-rmse:75.64171	validation_1-rmse:88.48957
[524]	validation_0-rmse:75.62586	validation_1-rmse:88.50102
[525]	validation_0-rmse:75.60614	validation_1-rmse:88.49388
[526]	validation_0-rmse:75.56393	validation_1-rmse:88.46977
[527]	validation_0-rmse:75.48361	validation_1-rmse:88.41893
[528]	validation_0-rmse:75.42419	validation_1-rmse:88.37189
[529]	validation_0-rmse:75.40351	validation_1-rmse:88.37443
[530]	validation_0-rmse:75.38856	validation_1-rmse:88.37479
[531]	validation_0-rmse:75.36294	validation_1-rmse:88.39674
[532]	validation_0-rmse:75.33125	validation_1-rmse:88.39040
[533]	validation_0-rmse:75.32692	validation_1-rmse:88.38983
[534]	validation_0-rmse:75.28359	validation_1-rmse:88.37022
[535]	validation_0-rmse:75.25903	validation_1-rmse:88.37529
[536]	validation_0-rmse:75.24383	validation_1-rmse:88.37695
[537]	validation_0-rmse:75.22379	validation_1-rmse:88.36802
[538]	validation_0-rmse:75.18264	validation_1-rmse:88.34621
[539]	validation_0-rmse:75.17674	validation_1-rmse:88.34249
[540]	validation_0-rmse:75.14658	validation_1-rmse:88.32879
[541]	validation_0-rmse:75.12090	validation_1-rmse:88.32256
[542]	validation_0-rmse:75.10338	validation_1-rmse:88.31270
[543]	validation_0-rmse:75.06870	validation_1-rmse:88.29210
[544]	validation_0-rmse:75.05239	validation_1-rmse:88.29033
[545]	validation_0-rmse:75.03019	validation_1-rmse:88.27616
[546]	validation_0-rmse:75.01716	validation_1-rmse:88.27697
[547]	validation_0-rmse:74.97546	validation_1-rmse:88.24008
[548]	validation_0-rmse:74.94398	validation_1-rmse:88.23079
[549]	validation_0-rmse:74.90149	validation_1-rmse:88.19659
[550]	validation_0-rmse:74.86139	validation_1-rmse:88.18480
[551]	validation_0-rmse:74.85103	validation_1-rmse:88.18671
[552]	validation_0-rmse:74.83571	validation_1-rmse:88.18756
[553]	validation_0-rmse:74.78171	validation_1-rmse:88.16911
[554]	validation_0-rmse:74.76860	validation_1-rmse:88.16544
[555]	validation_0-rmse:74.74391	validation_1-rmse:88.14353
[556]	validation_0-rmse:74.71499	validation_1-rmse:88.15184
[557]	validation_0-rmse:74.69669	validation_1-rmse:88.15136
[558]	validation_0-rmse:74.67200	validation_1-rmse:88.13734
[559]	validation_0-rmse:74.66242	validation_1-rmse:88.12909
[560]	validation_0-rmse:74.63645	validation_1-rmse:88.12176
[561]	validation_0-rmse:74.60316	validation_1-rmse:88.09150
[562]	validation_0-rmse:74.58552	validation_1-rmse:88.10060
[563]	validation_0-rmse:74.55085	validation_1-rmse:88.08877
[564]	validation_0-rmse:74.52112	validation_1-rmse:88.08348
[565]	validation_0-rmse:74.50055	validation_1-rmse:88.07379
[566]	validation_0-rmse:74.45644	validation_1-rmse:88.07372
[567]	validation_0-rmse:74.43793	validation_1-rmse:88.06508
[568]	validation_0-rmse:74.41069	validation_1-rmse:88.04296
[569]	validation_0-rmse:74.38734	validation_1-rmse:88.02601
[570]	validation_0-rmse:74.37349	validation_1-rmse:88.02182
[571]	validation_0-rmse:74.35603	validation_1-rmse:88.01070
[572]	validation_0-rmse:74.33290	validation_1-rmse:88.00153
[573]	validation_0-rmse:74.31915	validation_1-rmse:87.99900
[574]	validation_0-rmse:74.30568	validation_1-rmse:87.99480
[575]	validation_0-rmse:74.29417	validation_1-rmse:87.98396
[576]	validation_0-rmse:74.27272	validation_1-rmse:87.98148
[577]	validation_0-rmse:74.22902	validation_1-rmse:87.95951
[578]	validation_0-rmse:74.21899	validation_1-rmse:87.95304
[579]	validation_0-rmse:74.21088	validation_1-rmse:87.94744
[580]	validation_0-rmse:74.19419	validation_1-rmse:87.93257
[581]	validation_0-rmse:74.18026	validation_1-rmse:87.92084
[582]	validation_0-rmse:74.15478	validation_1-rmse:87.89490
[583]	validation_0-rmse:74.13941	validation_1-rmse:87.88758
[584]	validation_0-rmse:74.12293	validation_1-rmse:87.88961
[585]	validation_0-rmse:74.10313	validation_1-rmse:87.88043
[586]	validation_0-rmse:74.07797	validation_1-rmse:87.86035
[587]	validation_0-rmse:74.07257	validation_1-rmse:87.85696
[588]	validation_0-rmse:74.05836	validation_1-rmse:87.85706
[589]	validation_0-rmse:74.03962	validation_1-rmse:87.85010
[590]	validation_0-rmse:74.00821	validation_1-rmse:87.82999
[591]	validation_0-rmse:73.99320	validation_1-rmse:87.81963
[592]	validation_0-rmse:73.98352	validation_1-rmse:87.81463
[593]	validation_0-rmse:73.96530	validation_1-rmse:87.80276
[594]	validation_0-rmse:73.93064	validation_1-rmse:87.78197
[595]	validation_0-rmse:73.90446	validation_1-rmse:87.77288
[596]	validation_0-rmse:73.88877	validation_1-rmse:87.76644
[597]	validation_0-rmse:73.87377	validation_1-rmse:87.75979
[598]	validation_0-rmse:73.86210	validation_1-rmse:87.75630
[599]	validation_0-rmse:73.84679	validation_1-rmse:87.74731
[600]	validation_0-rmse:73.83123	validation_1-rmse:87.73410
[601]	validation_0-rmse:73.78759	validation_1-rmse:87.70859
[602]	validation_0-rmse:73.76666	validation_1-rmse:87.72829
[603]	validation_0-rmse:73.75524	validation_1-rmse:87.73216
[604]	validation_0-rmse:73.73655	validation_1-rmse:87.71723
[605]	validation_0-rmse:73.71060	validation_1-rmse:87.70676
[606]	validation_0-rmse:73.68715	validation_1-rmse:87.68785
[607]	validation_0-rmse:73.65315	validation_1-rmse:87.66319
[608]	validation_0-rmse:73.62269	validation_1-rmse:87.67375
[609]	validation_0-rmse:73.57093	validation_1-rmse:87.63668
[610]	validation_0-rmse:73.56384	validation_1-rmse:87.63090
[611]	validation_0-rmse:73.54577	validation_1-rmse:87.63040
[612]	validation_0-rmse:73.52719	validation_1-rmse:87.62105
[613]	validation_0-rmse:73.51399	validation_1-rmse:87.61833
[614]	validation_0-rmse:73.49329	validation_1-rmse:87.61169
[615]	validation_0-rmse:73.46685	validation_1-rmse:87.59519
[616]	validation_0-rmse:73.44059	validation_1-rmse:87.59481
[617]	validation_0-rmse:73.41311	validation_1-rmse:87.58048
[618]	validation_0-rmse:73.37333	validation_1-rmse:87.57765
[619]	validation_0-rmse:73.35336	validation_1-rmse:87.58522
[620]	validation_0-rmse:73.31509	validation_1-rmse:87.55650
[621]	validation_0-rmse:73.27654	validation_1-rmse:87.53757
[622]	validation_0-rmse:73.24219	validation_1-rmse:87.51510
[623]	validation_0-rmse:73.16628	validation_1-rmse:87.47832
[624]	validation_0-rmse:73.15572	validation_1-rmse:87.47451
[625]	validation_0-rmse:73.11113	validation_1-rmse:87.43617
[626]	validation_0-rmse:73.09120	validation_1-rmse:87.42329
[627]	validation_0-rmse:73.08116	validation_1-rmse:87.41646
[628]	validation_0-rmse:73.05331	validation_1-rmse:87.39366
[629]	validation_0-rmse:73.04399	validation_1-rmse:87.38690
[630]	validation_0-rmse:73.03086	validation_1-rmse:87.37955
[631]	validation_0-rmse:73.00766	validation_1-rmse:87.37507
[632]	validation_0-rmse:72.98498	validation_1-rmse:87.37034
[633]	validation_0-rmse:72.97046	validation_1-rmse:87.36770
[634]	validation_0-rmse:72.92319	validation_1-rmse:87.34791
[635]	validation_0-rmse:72.87846	validation_1-rmse:87.33781
[636]	validation_0-rmse:72.85857	validation_1-rmse:87.33818
[637]	validation_0-rmse:72.85544	validation_1-rmse:87.33900
[638]	validation_0-rmse:72.84432	validation_1-rmse:87.33515
[639]	validation_0-rmse:72.83529	validation_1-rmse:87.33142
[640]	validation_0-rmse:72.79708	validation_1-rmse:87.33303
[641]	validation_0-rmse:72.77716	validation_1-rmse:87.30853
[642]	validation_0-rmse:72.77114	validation_1-rmse:87.30691
[643]	validation_0-rmse:72.72518	validation_1-rmse:87.30298
[644]	validation_0-rmse:72.71155	validation_1-rmse:87.29656
[645]	validation_0-rmse:72.69573	validation_1-rmse:87.29332
[646]	validation_0-rmse:72.67433	validation_1-rmse:87.28199
[647]	validation_0-rmse:72.61252	validation_1-rmse:87.26172
[648]	validation_0-rmse:72.60147	validation_1-rmse:87.26286
[649]	validation_0-rmse:72.58245	validation_1-rmse:87.26022
[650]	validation_0-rmse:72.57274	validation_1-rmse:87.26443
[651]	validation_0-rmse:72.53442	validation_1-rmse:87.24159
[652]	validation_0-rmse:72.50490	validation_1-rmse:87.23756
[653]	validation_0-rmse:72.47454	validation_1-rmse:87.22773
[654]	validation_0-rmse:72.45972	validation_1-rmse:87.23677
[655]	validation_0-rmse:72.41736	validation_1-rmse:87.21830
[656]	validation_0-rmse:72.38761	validation_1-rmse:87.20123
[657]	validation_0-rmse:72.37475	validation_1-rmse:87.19751
[658]	validation_0-rmse:72.34525	validation_1-rmse:87.19322
[659]	validation_0-rmse:72.30842	validation_1-rmse:87.17789
[660]	validation_0-rmse:72.29181	validation_1-rmse:87.19067
[661]	validation_0-rmse:72.25605	validation_1-rmse:87.17970
[662]	validation_0-rmse:72.23247	validation_1-rmse:87.16839
[663]	validation_0-rmse:72.21859	validation_1-rmse:87.17376
[664]	validation_0-rmse:72.19324	validation_1-rmse:87.17143
[665]	validation_0-rmse:72.16848	validation_1-rmse:87.16248
[666]	validation_0-rmse:72.14709	validation_1-rmse:87.14872
[667]	validation_0-rmse:72.13015	validation_1-rmse:87.15223
[668]	validation_0-rmse:72.12515	validation_1-rmse:87.14588
[669]	validation_0-rmse:72.11993	validation_1-rmse:87.14255
[670]	validation_0-rmse:72.10417	validation_1-rmse:87.14271
[671]	validation_0-rmse:72.07496	validation_1-rmse:87.12371
[672]	validation_0-rmse:72.04172	validation_1-rmse:87.10769
[673]	validation_0-rmse:72.02135	validation_1-rmse:87.09196
[674]	validation_0-rmse:72.00821	validation_1-rmse:87.08017
[675]	validation_0-rmse:71.99854	validation_1-rmse:87.07828
[676]	validation_0-rmse:71.98172	validation_1-rmse:87.06991
[677]	validation_0-rmse:71.92181	validation_1-rmse:87.02310
[678]	validation_0-rmse:71.89428	validation_1-rmse:87.00758
[679]	validation_0-rmse:71.85527	validation_1-rmse:86.99169
[680]	validation_0-rmse:71.83453	validation_1-rmse:86.99693
[681]	validation_0-rmse:71.82020	validation_1-rmse:86.99766
[682]	validation_0-rmse:71.78676	validation_1-rmse:86.99421
[683]	validation_0-rmse:71.76697	validation_1-rmse:87.00001
[684]	validation_0-rmse:71.74579	validation_1-rmse:86.99600
[685]	validation_0-rmse:71.73658	validation_1-rmse:86.99829
[686]	validation_0-rmse:71.71685	validation_1-rmse:86.99166
[687]	validation_0-rmse:71.71106	validation_1-rmse:86.99099
[688]	validation_0-rmse:71.70613	validation_1-rmse:86.99143
[689]	validation_0-rmse:71.68927	validation_1-rmse:86.99796
[690]	validation_0-rmse:71.67816	validation_1-rmse:86.99550
[691]	validation_0-rmse:71.66343	validation_1-rmse:86.98881
[692]	validation_0-rmse:71.65778	validation_1-rmse:86.99200
[693]	validation_0-rmse:71.64914	validation_1-rmse:86.99192
[694]	validation_0-rmse:71.64003	validation_1-rmse:86.99046
[695]	validation_0-rmse:71.63224	validation_1-rmse:86.98599
[696]	validation_0-rmse:71.61318	validation_1-rmse:86.99624
[697]	validation_0-rmse:71.59667	validation_1-rmse:86.98820
[698]	validation_0-rmse:71.57083	validation_1-rmse:86.96850
[699]	validation_0-rmse:71.55259	validation_1-rmse:86.97440
[700]	validation_0-rmse:71.53327	validation_1-rmse:86.97557
[701]	validation_0-rmse:71.51672	validation_1-rmse:86.97630
[702]	validation_0-rmse:71.48794	validation_1-rmse:86.95886
[703]	validation_0-rmse:71.47654	validation_1-rmse:86.95229
[704]	validation_0-rmse:71.46134	validation_1-rmse:86.94907
[705]	validation_0-rmse:71.44314	validation_1-rmse:86.94188
[706]	validation_0-rmse:71.43174	validation_1-rmse:86.93842
[707]	validation_0-rmse:71.41932	validation_1-rmse:86.93231
[708]	validation_0-rmse:71.39084	validation_1-rmse:86.92221
[709]	validation_0-rmse:71.38759	validation_1-rmse:86.92062
[710]	validation_0-rmse:71.38375	validation_1-rmse:86.91957
[711]	validation_0-rmse:71.36066	validation_1-rmse:86.90987
[712]	validation_0-rmse:71.34069	validation_1-rmse:86.89875
[713]	validation_0-rmse:71.31489	validation_1-rmse:86.89849
[714]	validation_0-rmse:71.29562	validation_1-rmse:86.89645
[715]	validation_0-rmse:71.25848	validation_1-rmse:86.87903
[716]	validation_0-rmse:71.24842	validation_1-rmse:86.87724
[717]	validation_0-rmse:71.23583	validation_1-rmse:86.87246
[718]	validation_0-rmse:71.20184	validation_1-rmse:86.84916
[719]	validation_0-rmse:71.16706	validation_1-rmse:86.82793
[720]	validation_0-rmse:71.14106	validation_1-rmse:86.84011
[721]	validation_0-rmse:71.12852	validation_1-rmse:86.83697
[722]	validation_0-rmse:71.11263	validation_1-rmse:86.84501
[723]	validation_0-rmse:71.08349	validation_1-rmse:86.84233
[724]	validation_0-rmse:71.05627	validation_1-rmse:86.84695
[725]	validation_0-rmse:71.03122	validation_1-rmse:86.84628
[726]	validation_0-rmse:70.98065	validation_1-rmse:86.81746
[727]	validation_0-rmse:70.94306	validation_1-rmse:86.80855
[728]	validation_0-rmse:70.91499	validation_1-rmse:86.79578
[729]	validation_0-rmse:70.88597	validation_1-rmse:86.80863
[730]	validation_0-rmse:70.84777	validation_1-rmse:86.79360
[731]	validation_0-rmse:70.80882	validation_1-rmse:86.76691
[732]	validation_0-rmse:70.79510	validation_1-rmse:86.75862
[733]	validation_0-rmse:70.76832	validation_1-rmse:86.74619
[734]	validation_0-rmse:70.74919	validation_1-rmse:86.75050
[735]	validation_0-rmse:70.73316	validation_1-rmse:86.75093
[736]	validation_0-rmse:70.70580	validation_1-rmse:86.76612
[737]	validation_0-rmse:70.69318	validation_1-rmse:86.75349
[738]	validation_0-rmse:70.68300	validation_1-rmse:86.75260
[739]	validation_0-rmse:70.65734	validation_1-rmse:86.74827
[740]	validation_0-rmse:70.63861	validation_1-rmse:86.74706
[741]	validation_0-rmse:70.62730	validation_1-rmse:86.75401
[742]	validation_0-rmse:70.60686	validation_1-rmse:86.74530
[743]	validation_0-rmse:70.59840	validation_1-rmse:86.74462
[744]	validation_0-rmse:70.56397	validation_1-rmse:86.72091
[745]	validation_0-rmse:70.54317	validation_1-rmse:86.72531
[746]	validation_0-rmse:70.52197	validation_1-rmse:86.71089
[747]	validation_0-rmse:70.51131	validation_1-rmse:86.72111
[748]	validation_0-rmse:70.48904	validation_1-rmse:86.71649
[749]	validation_0-rmse:70.47705	validation_1-rmse:86.70977
[750]	validation_0-rmse:70.46806	validation_1-rmse:86.70745
[751]	validation_0-rmse:70.46138	validation_1-rmse:86.70537
[752]	validation_0-rmse:70.43206	validation_1-rmse:86.68185
[753]	validation_0-rmse:70.41702	validation_1-rmse:86.68096
[754]	validation_0-rmse:70.40808	validation_1-rmse:86.67875
[755]	validation_0-rmse:70.40418	validation_1-rmse:86.67604
[756]	validation_0-rmse:70.38393	validation_1-rmse:86.67913
[757]	validation_0-rmse:70.36140	validation_1-rmse:86.67334
[758]	validation_0-rmse:70.35346	validation_1-rmse:86.66820
[759]	validation_0-rmse:70.32730	validation_1-rmse:86.66483
[760]	validation_0-rmse:70.31057	validation_1-rmse:86.66762
[761]	validation_0-rmse:70.29108	validation_1-rmse:86.65775
[762]	validation_0-rmse:70.27421	validation_1-rmse:86.65298
[763]	validation_0-rmse:70.26155	validation_1-rmse:86.66924
[764]	validation_0-rmse:70.23536	validation_1-rmse:86.65425
[765]	validation_0-rmse:70.19585	validation_1-rmse:86.63800
[766]	validation_0-rmse:70.17549	validation_1-rmse:86.63297
[767]	validation_0-rmse:70.15206	validation_1-rmse:86.63804
[768]	validation_0-rmse:70.14916	validation_1-rmse:86.63706
[769]	validation_0-rmse:70.14064	validation_1-rmse:86.63343
[770]	validation_0-rmse:70.11901	validation_1-rmse:86.62591
[771]	validation_0-rmse:70.08984	validation_1-rmse:86.61702
[772]	validation_0-rmse:70.07541	validation_1-rmse:86.61225
[773]	validation_0-rmse:70.06158	validation_1-rmse:86.60998
[774]	validation_0-rmse:70.04779	validation_1-rmse:86.60897
[775]	validation_0-rmse:70.02547	validation_1-rmse:86.59677
[776]	validation_0-rmse:70.00841	validation_1-rmse:86.59563
[777]	validation_0-rmse:70.00184	validation_1-rmse:86.59903
[778]	validation_0-rmse:69.98319	validation_1-rmse:86.59169
[779]	validation_0-rmse:69.95353	validation_1-rmse:86.58420
[780]	validation_0-rmse:69.93375	validation_1-rmse:86.58969
[781]	validation_0-rmse:69.92213	validation_1-rmse:86.59417
[782]	validation_0-rmse:69.89982	validation_1-rmse:86.58958
[783]	validation_0-rmse:69.89146	validation_1-rmse:86.59280
[784]	validation_0-rmse:69.88301	validation_1-rmse:86.59163
[785]	validation_0-rmse:69.86210	validation_1-rmse:86.59782
[786]	validation_0-rmse:69.84826	validation_1-rmse:86.59100
[787]	validation_0-rmse:69.81298	validation_1-rmse:86.56765
[788]	validation_0-rmse:69.77332	validation_1-rmse:86.56335
[789]	validation_0-rmse:69.76382	validation_1-rmse:86.56811
[790]	validation_0-rmse:69.74178	validation_1-rmse:86.56611
[791]	validation_0-rmse:69.71167	validation_1-rmse:86.54925
[792]	validation_0-rmse:69.70090	validation_1-rmse:86.54142
[793]	validation_0-rmse:69.67710	validation_1-rmse:86.53788
[794]	validation_0-rmse:69.66214	validation_1-rmse:86.53645
[795]	validation_0-rmse:69.64548	validation_1-rmse:86.52882
[796]	validation_0-rmse:69.64019	validation_1-rmse:86.53218
[797]	validation_0-rmse:69.61385	validation_1-rmse:86.54262
[798]	validation_0-rmse:69.60884	validation_1-rmse:86.54714
[799]	validation_0-rmse:69.58207	validation_1-rmse:86.52654
[800]	validation_0-rmse:69.56150	validation_1-rmse:86.53580
[801]	validation_0-rmse:69.54139	validation_1-rmse:86.53655
[802]	validation_0-rmse:69.52902	validation_1-rmse:86.52754
[803]	validation_0-rmse:69.51330	validation_1-rmse:86.53176
[804]	validation_0-rmse:69.49582	validation_1-rmse:86.52691
[805]	validation_0-rmse:69.48658	validation_1-rmse:86.53155
[806]	validation_0-rmse:69.47942	validation_1-rmse:86.52804
[807]	validation_0-rmse:69.45082	validation_1-rmse:86.51313
[808]	validation_0-rmse:69.41986	validation_1-rmse:86.49877
[809]	validation_0-rmse:69.41328	validation_1-rmse:86.49155
[810]	validation_0-rmse:69.39866	validation_1-rmse:86.49260
[811]	validation_0-rmse:69.38246	validation_1-rmse:86.48592
[812]	validation_0-rmse:69.36522	validation_1-rmse:86.49039
[813]	validation_0-rmse:69.34669	validation_1-rmse:86.49313
[814]	validation_0-rmse:69.33252	validation_1-rmse:86.48766
[815]	validation_0-rmse:69.31567	validation_1-rmse:86.49200
[816]	validation_0-rmse:69.29708	validation_1-rmse:86.49404
[817]	validation_0-rmse:69.28074	validation_1-rmse:86.50596
[818]	validation_0-rmse:69.25629	validation_1-rmse:86.49366
[819]	validation_0-rmse:69.22509	validation_1-rmse:86.47757
[820]	validation_0-rmse:69.21245	validation_1-rmse:86.47450
[821]	validation_0-rmse:69.19350	validation_1-rmse:86.46277
[822]	validation_0-rmse:69.17476	validation_1-rmse:86.47197
[823]	validation_0-rmse:69.16023	validation_1-rmse:86.47382
[824]	validation_0-rmse:69.14303	validation_1-rmse:86.46894
[825]	validation_0-rmse:69.13580	validation_1-rmse:86.46404
[826]	validation_0-rmse:69.12363	validation_1-rmse:86.46444
[827]	validation_0-rmse:69.09944	validation_1-rmse:86.45148
[828]	validation_0-rmse:69.08076	validation_1-rmse:86.45809
[829]	validation_0-rmse:69.07122	validation_1-rmse:86.46061
[830]	validation_0-rmse:69.06623	validation_1-rmse:86.46175
[831]	validation_0-rmse:69.04190	validation_1-rmse:86.44704
[832]	validation_0-rmse:69.03087	validation_1-rmse:86.44299
[833]	validation_0-rmse:69.02177	validation_1-rmse:86.44398
[834]	validation_0-rmse:68.99112	validation_1-rmse:86.42857
[835]	validation_0-rmse:68.97080	validation_1-rmse:86.40888
[836]	validation_0-rmse:68.95505	validation_1-rmse:86.39628
[837]	validation_0-rmse:68.92570	validation_1-rmse:86.37989
[838]	validation_0-rmse:68.90959	validation_1-rmse:86.38493
[839]	validation_0-rmse:68.88491	validation_1-rmse:86.36969
[840]	validation_0-rmse:68.86291	validation_1-rmse:86.35596
[841]	validation_0-rmse:68.85551	validation_1-rmse:86.35204
[842]	validation_0-rmse:68.83605	validation_1-rmse:86.33410
[843]	validation_0-rmse:68.82846	validation_1-rmse:86.32994
[844]	validation_0-rmse:68.81706	validation_1-rmse:86.32534
[845]	validation_0-rmse:68.80766	validation_1-rmse:86.31816
[846]	validation_0-rmse:68.79427	validation_1-rmse:86.31565
[847]	validation_0-rmse:68.77926	validation_1-rmse:86.31492
[848]	validation_0-rmse:68.76491	validation_1-rmse:86.30851
[849]	validation_0-rmse:68.75239	validation_1-rmse:86.30529
[850]	validation_0-rmse:68.72485	validation_1-rmse:86.28680
[851]	validation_0-rmse:68.71419	validation_1-rmse:86.27944
[852]	validation_0-rmse:68.69805	validation_1-rmse:86.27361
[853]	validation_0-rmse:68.67952	validation_1-rmse:86.27837
[854]	validation_0-rmse:68.67185	validation_1-rmse:86.28056
[855]	validation_0-rmse:68.65173	validation_1-rmse:86.26919
[856]	validation_0-rmse:68.64088	validation_1-rmse:86.26562
[857]	validation_0-rmse:68.62082	validation_1-rmse:86.25411
[858]	validation_0-rmse:68.59754	validation_1-rmse:86.25213
[859]	validation_0-rmse:68.57322	validation_1-rmse:86.23534
[860]	validation_0-rmse:68.55437	validation_1-rmse:86.23044
[861]	validation_0-rmse:68.52648	validation_1-rmse:86.24123
[862]	validation_0-rmse:68.50471	validation_1-rmse:86.23397
[863]	validation_0-rmse:68.48385	validation_1-rmse:86.22416
[864]	validation_0-rmse:68.45636	validation_1-rmse:86.22289
[865]	validation_0-rmse:68.44738	validation_1-rmse:86.22537
[866]	validation_0-rmse:68.44421	validation_1-rmse:86.22400
[867]	validation_0-rmse:68.41140	validation_1-rmse:86.21396
[868]	validation_0-rmse:68.40011	validation_1-rmse:86.21172
[869]	validation_0-rmse:68.38353	validation_1-rmse:86.21806
[870]	validation_0-rmse:68.36929	validation_1-rmse:86.20888
[871]	validation_0-rmse:68.35385	validation_1-rmse:86.21373
[872]	validation_0-rmse:68.33568	validation_1-rmse:86.21435
[873]	validation_0-rmse:68.31958	validation_1-rmse:86.20608
[874]	validation_0-rmse:68.31482	validation_1-rmse:86.20306
[875]	validation_0-rmse:68.30208	validation_1-rmse:86.20142
[876]	validation_0-rmse:68.30005	validation_1-rmse:86.20035
[877]	validation_0-rmse:68.28839	validation_1-rmse:86.19890
[878]	validation_0-rmse:68.26966	validation_1-rmse:86.19087
[879]	validation_0-rmse:68.25848	validation_1-rmse:86.19002
[880]	validation_0-rmse:68.24524	validation_1-rmse:86.17948
[881]	validation_0-rmse:68.23869	validation_1-rmse:86.17687
[882]	validation_0-rmse:68.22889	validation_1-rmse:86.17969
[883]	validation_0-rmse:68.19545	validation_1-rmse:86.17331
[884]	validation_0-rmse:68.14941	validation_1-rmse:86.13893
[885]	validation_0-rmse:68.13101	validation_1-rmse:86.13097
[886]	validation_0-rmse:68.10426	validation_1-rmse:86.12044
[887]	validation_0-rmse:68.09205	validation_1-rmse:86.11855
[888]	validation_0-rmse:68.08125	validation_1-rmse:86.11772
[889]	validation_0-rmse:68.05845	validation_1-rmse:86.11113
[890]	validation_0-rmse:68.03858	validation_1-rmse:86.09746
[891]	validation_0-rmse:68.02581	validation_1-rmse:86.09578
[892]	validation_0-rmse:68.00926	validation_1-rmse:86.10008
[893]	validation_0-rmse:67.98912	validation_1-rmse:86.09532
[894]	validation_0-rmse:67.96570	validation_1-rmse:86.08658
[895]	validation_0-rmse:67.95345	validation_1-rmse:86.08101
[896]	validation_0-rmse:67.94290	validation_1-rmse:86.08054
[897]	validation_0-rmse:67.92299	validation_1-rmse:86.08354
[898]	validation_0-rmse:67.89410	validation_1-rmse:86.06676
[899]	validation_0-rmse:67.87702	validation_1-rmse:86.07316
[900]	validation_0-rmse:67.86251	validation_1-rmse:86.07168
[901]	validation_0-rmse:67.84113	validation_1-rmse:86.05617
[902]	validation_0-rmse:67.82990	validation_1-rmse:86.04879
[903]	validation_0-rmse:67.80810	validation_1-rmse:86.03616
[904]	validation_0-rmse:67.79768	validation_1-rmse:86.03392
[905]	validation_0-rmse:67.77796	validation_1-rmse:86.02774
[906]	validation_0-rmse:67.76859	validation_1-rmse:86.03194
[907]	validation_0-rmse:67.74455	validation_1-rmse:86.02755
[908]	validation_0-rmse:67.73193	validation_1-rmse:86.02470
[909]	validation_0-rmse:67.72488	validation_1-rmse:86.02998
[910]	validation_0-rmse:67.69530	validation_1-rmse:86.00717
[911]	validation_0-rmse:67.68652	validation_1-rmse:86.00811
[912]	validation_0-rmse:67.67580	validation_1-rmse:86.00347
[913]	validation_0-rmse:67.65679	validation_1-rmse:85.99609
[914]	validation_0-rmse:67.64559	validation_1-rmse:85.99290
[915]	validation_0-rmse:67.63846	validation_1-rmse:85.99039
[916]	validation_0-rmse:67.62964	validation_1-rmse:85.98961
[917]	validation_0-rmse:67.61188	validation_1-rmse:85.99007
[918]	validation_0-rmse:67.58249	validation_1-rmse:85.96927
[919]	validation_0-rmse:67.57164	validation_1-rmse:85.96744
[920]	validation_0-rmse:67.56619	validation_1-rmse:85.96882
[921]	validation_0-rmse:67.53720	validation_1-rmse:85.96222
[922]	validation_0-rmse:67.52871	validation_1-rmse:85.95825
[923]	validation_0-rmse:67.51577	validation_1-rmse:85.95075
[924]	validation_0-rmse:67.50652	validation_1-rmse:85.95051
[925]	validation_0-rmse:67.47981	validation_1-rmse:85.93527
[926]	validation_0-rmse:67.46073	validation_1-rmse:85.94393
[927]	validation_0-rmse:67.43801	validation_1-rmse:85.94026
[928]	validation_0-rmse:67.42782	validation_1-rmse:85.93994
[929]	validation_0-rmse:67.41080	validation_1-rmse:85.94225
[930]	validation_0-rmse:67.39510	validation_1-rmse:85.94039
[931]	validation_0-rmse:67.37417	validation_1-rmse:85.92538
[932]	validation_0-rmse:67.35678	validation_1-rmse:85.92277
[933]	validation_0-rmse:67.32743	validation_1-rmse:85.91548
[934]	validation_0-rmse:67.31807	validation_1-rmse:85.91546
[935]	validation_0-rmse:67.30636	validation_1-rmse:85.92008
[936]	validation_0-rmse:67.29372	validation_1-rmse:85.92444
[937]	validation_0-rmse:67.27731	validation_1-rmse:85.93199
[938]	validation_0-rmse:67.25615	validation_1-rmse:85.92649
[939]	validation_0-rmse:67.25015	validation_1-rmse:85.92406
[940]	validation_0-rmse:67.24318	validation_1-rmse:85.91737
[941]	validation_0-rmse:67.23635	validation_1-rmse:85.91291
[942]	validation_0-rmse:67.21045	validation_1-rmse:85.89941
[943]	validation_0-rmse:67.19427	validation_1-rmse:85.90137
[944]	validation_0-rmse:67.18996	validation_1-rmse:85.90047
[945]	validation_0-rmse:67.17350	validation_1-rmse:85.90463
[946]	validation_0-rmse:67.17133	validation_1-rmse:85.90549
[947]	validation_0-rmse:67.15461	validation_1-rmse:85.90668
[948]	validation_0-rmse:67.14521	validation_1-rmse:85.91740
[949]	validation_0-rmse:67.13437	validation_1-rmse:85.91609
[950]	validation_0-rmse:67.11339	validation_1-rmse:85.91667
[951]	validation_0-rmse:67.09775	validation_1-rmse:85.90924
[952]	validation_0-rmse:67.08680	validation_1-rmse:85.91090
[953]	validation_0-rmse:67.06268	validation_1-rmse:85.89127
[954]	validation_0-rmse:67.05379	validation_1-rmse:85.88696
[955]	validation_0-rmse:67.03301	validation_1-rmse:85.87727
[956]	validation_0-rmse:67.01963	validation_1-rmse:85.86916
[957]	validation_0-rmse:67.00109	validation_1-rmse:85.88220
[958]	validation_0-rmse:66.99025	validation_1-rmse:85.87114
[959]	validation_0-rmse:66.97263	validation_1-rmse:85.86782
[960]	validation_0-rmse:66.94867	validation_1-rmse:85.85342
[961]	validation_0-rmse:66.93337	validation_1-rmse:85.84579
[962]	validation_0-rmse:66.92107	validation_1-rmse:85.84216
[963]	validation_0-rmse:66.90853	validation_1-rmse:85.84109
[964]	validation_0-rmse:66.89911	validation_1-rmse:85.84359
[965]	validation_0-rmse:66.87551	validation_1-rmse:85.83779
[966]	validation_0-rmse:66.84363	validation_1-rmse:85.82964
[967]	validation_0-rmse:66.82586	validation_1-rmse:85.81823
[968]	validation_0-rmse:66.81469	validation_1-rmse:85.81668
[969]	validation_0-rmse:66.79682	validation_1-rmse:85.80795
[970]	validation_0-rmse:66.78409	validation_1-rmse:85.79837
[971]	validation_0-rmse:66.76601	validation_1-rmse:85.79866
[972]	validation_0-rmse:66.75667	validation_1-rmse:85.79433
[973]	validation_0-rmse:66.74261	validation_1-rmse:85.79141
[974]	validation_0-rmse:66.73481	validation_1-rmse:85.79178
[975]	validation_0-rmse:66.72013	validation_1-rmse:85.80581
[976]	validation_0-rmse:66.70552	validation_1-rmse:85.79835
[977]	validation_0-rmse:66.69706	validation_1-rmse:85.79032
[978]	validation_0-rmse:66.66054	validation_1-rmse:85.78059
[979]	validation_0-rmse:66.64886	validation_1-rmse:85.77754
[980]	validation_0-rmse:66.64063	validation_1-rmse:85.77659
[981]	validation_0-rmse:66.62644	validation_1-rmse:85.77915
[982]	validation_0-rmse:66.61810	validation_1-rmse:85.77545
[983]	validation_0-rmse:66.60345	validation_1-rmse:85.76226
[984]	validation_0-rmse:66.59459	validation_1-rmse:85.76328
[985]	validation_0-rmse:66.58749	validation_1-rmse:85.76166
[986]	validation_0-rmse:66.57924	validation_1-rmse:85.76579
[987]	validation_0-rmse:66.57083	validation_1-rmse:85.75833
[988]	validation_0-rmse:66.56732	validation_1-rmse:85.75831
[989]	validation_0-rmse:66.55096	validation_1-rmse:85.75304
[990]	validation_0-rmse:66.54301	validation_1-rmse:85.74943
[991]	validation_0-rmse:66.52103	validation_1-rmse:85.75690
[992]	validation_0-rmse:66.49366	validation_1-rmse:85.74703
[993]	validation_0-rmse:66.47459	validation_1-rmse:85.73909
[994]	validation_0-rmse:66.45697	validation_1-rmse:85.74579
[995]	validation_0-rmse:66.44488	validation_1-rmse:85.74876
[996]	validation_0-rmse:66.43914	validation_1-rmse:85.74939
[997]	validation_0-rmse:66.42767	validation_1-rmse:85.74802
[998]	validation_0-rmse:66.40684	validation_1-rmse:85.74198
[999]	validation_0-rmse:66.39735	validation_1-rmse:85.74362
&gt;&gt;&gt; Using model to predict target Rg_1_1_1 in unseen test data ...
&gt;&gt;&gt; Using model to calculate permutation importance based on unseen test data ...
&gt;&gt;&gt; Calculating prediction scores based on predicting unseen test data of Rg_1_1_1 ...
&gt;&gt;&gt; Collecting results, details about training and testing can be accessed by calling .report_traintest().
&gt;&gt;&gt; Done.

================================
MODEL TRAINING &amp; TESTING RESULTS
================================

## DATA
  &gt; target: Rg_1_1_1
  &gt; features: 11 [&#39;SW_IN_POT&#39;, &#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.RECORDNUMBER&#39;]
  &gt; 350640 records (with missing)
  &gt; 350627 available records for target and all features (no missing values)
  &gt; training on 262970 records (75.0%) of 262970 features between 2005-01-01 01:00:00 and 2024-12-31 23:30:00
  &gt; testing on 87657 unseen records (25.0%) of Rg_1_1_1 between 2005-01-01 00:30:00 and 2025-01-01 00:00:00

## MODEL
  &gt; the model was trained on training data (262970 records)
  &gt; the model was tested on test data (87657 values)
  &gt; estimator:  XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=50,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=1000, n_jobs=-1,
             num_parallel_tree=None, random_state=42, ...)
  &gt; parameters:  {&#39;objective&#39;: &#39;reg:squarederror&#39;, &#39;base_score&#39;: None, &#39;booster&#39;: None, &#39;callbacks&#39;: None, &#39;colsample_bylevel&#39;: None, &#39;colsample_bynode&#39;: None, &#39;colsample_bytree&#39;: None, &#39;device&#39;: None, &#39;early_stopping_rounds&#39;: 50, &#39;enable_categorical&#39;: False, &#39;eval_metric&#39;: None, &#39;feature_types&#39;: None, &#39;gamma&#39;: None, &#39;grow_policy&#39;: None, &#39;importance_type&#39;: None, &#39;interaction_constraints&#39;: None, &#39;learning_rate&#39;: None, &#39;max_bin&#39;: None, &#39;max_cat_threshold&#39;: None, &#39;max_cat_to_onehot&#39;: None, &#39;max_delta_step&#39;: None, &#39;max_depth&#39;: None, &#39;max_leaves&#39;: None, &#39;min_child_weight&#39;: None, &#39;missing&#39;: nan, &#39;monotone_constraints&#39;: None, &#39;multi_strategy&#39;: None, &#39;n_estimators&#39;: 1000, &#39;n_jobs&#39;: -1, &#39;num_parallel_tree&#39;: None, &#39;random_state&#39;: 42, &#39;reg_alpha&#39;: None, &#39;reg_lambda&#39;: None, &#39;sampling_method&#39;: None, &#39;scale_pos_weight&#39;: None, &#39;subsample&#39;: None, &#39;tree_method&#39;: None, &#39;validate_parameters&#39;: None, &#39;verbosity&#39;: None}
  &gt; number of features used in model:  11
  &gt; names of features used in model:  [&#39;SW_IN_POT&#39;, &#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.RECORDNUMBER&#39;]

## FEATURE IMPORTANCES
  &gt; feature importances were calculated based on unseen test data of Rg_1_1_1 (87657 records).
  &gt; feature importances are showing permutation importances from 10 repeats

               PERM_IMPORTANCE   PERM_SD
SW_IN_POT             1.605544  0.006996
.RECORDNUMBER         0.413643  0.004274
.DOY                  0.405730  0.003395
.YEARDOY              0.348721  0.003892
.YEARWEEK             0.345846  0.002608
.WEEK                 0.304241  0.002830
.YEARMONTH            0.296862  0.001666
.HOUR                 0.033396  0.000577
.YEAR                 0.028911  0.000574
.MONTH                0.018922  0.000373
.SEASON               0.003131  0.000180


## MODEL SCORES
  All scores were calculated based on unseen test data (87657 records).
  &gt; MAE:  44.301786123913004 (mean absolute error)
  &gt; MedAE:  10.615911483764648 (median absolute error)
  &gt; MSE:  7351.191496606298 (mean squared error)
  &gt; RMSE:  85.73908966513639 (root mean squared error)
  &gt; MAXE:  879.662240234375 (max error)
  &gt; MAPE:  10761904357104538.000 (mean absolute percentage error)
  &gt; R2:  0.8649081833687097
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span><span class="o">.</span><span class="n">fillgaps</span><span class="p">(</span><span class="n">showplot_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showplot_importance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xgb</span><span class="o">.</span><span class="n">report_gapfilling</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gap-filling using final model ...
&gt;&gt;&gt; Using final model on all data to predict target Rg_1_1_1 ...
&gt;&gt;&gt; Using final model on all data to calculate permutation importance ...
&gt;&gt;&gt; Calculating prediction scores based on all data predicting Rg_1_1_1 ...
&gt;&gt;&gt; Predicting target Rg_1_1_1 where all features are available ... predicted 350640 records.
&gt;&gt;&gt; Collecting results for final model ...
&gt;&gt;&gt; Filling 13 missing records in target with predictions from final model ...
&gt;&gt;&gt; Storing gap-filled time series in variable Rg_1_1_1_gfXG ...
&gt;&gt;&gt; Restoring original timestamp in results ...
&gt;&gt;&gt; Combining predictions from full model and fallback model ...

===================
GAP-FILLING RESULTS
===================

Model scores and feature importances were calculated from high-quality predicted targets (13 values, Rg_1_1_1_gfXG where flag=1) in comparison to observed targets (350627 values, Rg_1_1_1).

## TARGET
- first timestamp:  2005-01-01 00:30:00
- last timestamp:  2025-01-01 00:00:00
- potential number of values: 350640 values)
- target column (observed):  Rg_1_1_1
- missing records (observed):  13 (cross-check from flag: 13)
- target column (gap-filled):  Rg_1_1_1_gfXG  (350640 values)
- missing records (gap-filled):  0
- gap-filling flag: FLAG_Rg_1_1_1_gfXG_ISFILLED
  &gt; flag 0 ... observed targets (350627 values)
  &gt; flag 1 ... targets gap-filled with high-quality, all features available (13 values)
  &gt; flag 2 ... targets gap-filled with fallback (0 values)

## FEATURE IMPORTANCES
- names of features used in model:  [&#39;SW_IN_POT&#39;, &#39;.DOY&#39;, &#39;.RECORDNUMBER&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.WEEK&#39;, &#39;.YEARMONTH&#39;, &#39;.HOUR&#39;, &#39;.YEAR&#39;, &#39;.MONTH&#39;, &#39;.SEASON&#39;]
- number of features used in model:  11
- permutation importances were calculated from 10 repeats.

               PERM_IMPORTANCE   PERM_SD
SW_IN_POT             1.639269  0.003677
.DOY                  0.421002  0.002084
.RECORDNUMBER         0.417221  0.002751
.YEARDOY              0.353347  0.001624
.YEARWEEK             0.350219  0.001852
.WEEK                 0.310295  0.001742
.YEARMONTH            0.302284  0.001636
.HOUR                 0.040667  0.000373
.YEAR                 0.033936  0.000245
.MONTH                0.019364  0.000259
.SEASON               0.003189  0.000110

## MODEL
The model was trained on a training set with test size 25.00%.
- estimator:  XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=50,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=1000, n_jobs=-1,
             num_parallel_tree=None, random_state=42, ...)
- parameters:  {&#39;objective&#39;: &#39;reg:squarederror&#39;, &#39;base_score&#39;: None, &#39;booster&#39;: None, &#39;callbacks&#39;: None, &#39;colsample_bylevel&#39;: None, &#39;colsample_bynode&#39;: None, &#39;colsample_bytree&#39;: None, &#39;device&#39;: None, &#39;early_stopping_rounds&#39;: 50, &#39;enable_categorical&#39;: False, &#39;eval_metric&#39;: None, &#39;feature_types&#39;: None, &#39;gamma&#39;: None, &#39;grow_policy&#39;: None, &#39;importance_type&#39;: None, &#39;interaction_constraints&#39;: None, &#39;learning_rate&#39;: None, &#39;max_bin&#39;: None, &#39;max_cat_threshold&#39;: None, &#39;max_cat_to_onehot&#39;: None, &#39;max_delta_step&#39;: None, &#39;max_depth&#39;: None, &#39;max_leaves&#39;: None, &#39;min_child_weight&#39;: None, &#39;missing&#39;: nan, &#39;monotone_constraints&#39;: None, &#39;multi_strategy&#39;: None, &#39;n_estimators&#39;: 1000, &#39;n_jobs&#39;: -1, &#39;num_parallel_tree&#39;: None, &#39;random_state&#39;: 42, &#39;reg_alpha&#39;: None, &#39;reg_lambda&#39;: None, &#39;sampling_method&#39;: None, &#39;scale_pos_weight&#39;: None, &#39;subsample&#39;: None, &#39;tree_method&#39;: None, &#39;validate_parameters&#39;: None, &#39;verbosity&#39;: None}

## MODEL SCORES
- MAE:  37.31551461741382 (mean absolute error)
- MedAE:  9.91182804107666 (median absolute error)
- MSE:  5151.952874130383 (mean squared error)
- RMSE:  71.77710550119991 (root mean squared error)
- MAXE:  879.662240234375 (max error)
- MAPE:  10527766956897402.000 (mean absolute percentage error)
- R2:  0.905857821691373
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observed</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">]</span>
<span class="n">gapfilled</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">get_gapfilled_target</span><span class="p">()</span>
<span class="n">data_simple_merged</span><span class="p">[</span><span class="n">gapfilled</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">gapfilled</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Short-wave incoming radiation&quot;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">TimeSeries</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">gapfilled</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">TimeSeries</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># ax.set_ylim(-2000, 200)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e578c757c709442c86ea865ff44bb7a60ef860c9af3bc97b6252f732561344a0.png" src="../_images/e578c757c709442c86ea865ff44bb7a60ef860c9af3bc97b6252f732561344a0.png" />
</div>
</div>
</section>
<section id="ta">
<h2>TA<a class="headerlink" href="#ta" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;SW_IN_POT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">potrad</span><span class="p">(</span><span class="n">timestamp_index</span><span class="o">=</span><span class="n">_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                          <span class="n">lat</span><span class="o">=</span><span class="mf">47.210227</span><span class="p">,</span>  <span class="c1"># CH-CHA</span>
                          <span class="n">lon</span><span class="o">=</span><span class="mf">8.410645</span><span class="p">,</span>  <span class="c1"># CH-CHA</span>
                          <span class="n">utc_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rg_1_1_1_gfXG</th>
      <th>Ta_1_1_1</th>
      <th>SW_IN_POT</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>0.0</td>
      <td>2.241000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>0.0</td>
      <td>2.273000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>0.0</td>
      <td>2.305000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>0.0</td>
      <td>2.284000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>0.0</td>
      <td>2.264000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>0.0</td>
      <td>-1.919472</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>0.0</td>
      <td>-2.104678</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>0.0</td>
      <td>-2.089444</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>0.0</td>
      <td>-2.355761</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>0.0</td>
      <td>-2.578839</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span> <span class="o">=</span> <span class="n">XGBoostTS</span><span class="p">(</span>
    <span class="n">input_df</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
    <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">,</span>
    <span class="n">perm_n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">include_timestamp_as_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_continuous_record_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adding new data columns ...
++ Added new columns with timestamp info: [&#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;] 
++ Added new column .RECORDNUMBER with record numbers from 1 to 350640.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span><span class="o">.</span><span class="n">trainmodel</span><span class="p">(</span><span class="n">showplot_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showplot_importance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xgb</span><span class="o">.</span><span class="n">report_traintest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training final model ...
&gt;&gt;&gt; Training model &lt;class &#39;xgboost.sklearn.XGBRegressor&#39;&gt; based on data between 2005-01-01 01:00:00 and 2025-01-01 00:00:00 ...
&gt;&gt;&gt; Fitting model to training data ...
[0]	validation_0-rmse:6.58563	validation_1-rmse:6.57848
[1]	validation_0-rmse:5.35856	validation_1-rmse:5.35302
[2]	validation_0-rmse:4.59739	validation_1-rmse:4.59472
[3]	validation_0-rmse:4.12936	validation_1-rmse:4.12624
[4]	validation_0-rmse:3.85686	validation_1-rmse:3.85702
[5]	validation_0-rmse:3.68221	validation_1-rmse:3.68501
[6]	validation_0-rmse:3.56956	validation_1-rmse:3.57416
[7]	validation_0-rmse:3.50626	validation_1-rmse:3.51392
[8]	validation_0-rmse:3.45645	validation_1-rmse:3.46526
[9]	validation_0-rmse:3.41856	validation_1-rmse:3.42733
[10]	validation_0-rmse:3.39365	validation_1-rmse:3.40340
[11]	validation_0-rmse:3.35313	validation_1-rmse:3.36345
[12]	validation_0-rmse:3.33336	validation_1-rmse:3.34464
[13]	validation_0-rmse:3.31356	validation_1-rmse:3.32583
[14]	validation_0-rmse:3.28622	validation_1-rmse:3.29857
[15]	validation_0-rmse:3.25551	validation_1-rmse:3.26800
[16]	validation_0-rmse:3.23983	validation_1-rmse:3.25279
[17]	validation_0-rmse:3.21890	validation_1-rmse:3.23307
[18]	validation_0-rmse:3.20321	validation_1-rmse:3.21837
[19]	validation_0-rmse:3.19388	validation_1-rmse:3.20991
[20]	validation_0-rmse:3.17869	validation_1-rmse:3.19511
[21]	validation_0-rmse:3.13807	validation_1-rmse:3.15571
[22]	validation_0-rmse:3.13083	validation_1-rmse:3.14967
[23]	validation_0-rmse:3.12045	validation_1-rmse:3.13978
[24]	validation_0-rmse:3.09385	validation_1-rmse:3.11285
[25]	validation_0-rmse:3.08725	validation_1-rmse:3.10715
[26]	validation_0-rmse:3.05860	validation_1-rmse:3.07974
[27]	validation_0-rmse:3.03710	validation_1-rmse:3.05939
[28]	validation_0-rmse:3.02506	validation_1-rmse:3.04704
[29]	validation_0-rmse:3.00381	validation_1-rmse:3.02661
[30]	validation_0-rmse:2.99250	validation_1-rmse:3.01562
[31]	validation_0-rmse:2.98039	validation_1-rmse:3.00370
[32]	validation_0-rmse:2.95790	validation_1-rmse:2.98144
[33]	validation_0-rmse:2.95294	validation_1-rmse:2.97647
[34]	validation_0-rmse:2.94175	validation_1-rmse:2.96566
[35]	validation_0-rmse:2.93328	validation_1-rmse:2.95736
[36]	validation_0-rmse:2.90899	validation_1-rmse:2.93394
[37]	validation_0-rmse:2.89566	validation_1-rmse:2.92063
[38]	validation_0-rmse:2.88962	validation_1-rmse:2.91606
[39]	validation_0-rmse:2.88090	validation_1-rmse:2.90794
[40]	validation_0-rmse:2.86194	validation_1-rmse:2.88936
[41]	validation_0-rmse:2.84852	validation_1-rmse:2.87566
[42]	validation_0-rmse:2.84468	validation_1-rmse:2.87208
[43]	validation_0-rmse:2.83514	validation_1-rmse:2.86385
[44]	validation_0-rmse:2.82908	validation_1-rmse:2.85877
[45]	validation_0-rmse:2.82507	validation_1-rmse:2.85577
[46]	validation_0-rmse:2.82099	validation_1-rmse:2.85167
[47]	validation_0-rmse:2.80473	validation_1-rmse:2.83658
[48]	validation_0-rmse:2.79482	validation_1-rmse:2.82675
[49]	validation_0-rmse:2.78133	validation_1-rmse:2.81281
[50]	validation_0-rmse:2.77224	validation_1-rmse:2.80500
[51]	validation_0-rmse:2.76106	validation_1-rmse:2.79378
[52]	validation_0-rmse:2.75608	validation_1-rmse:2.78904
[53]	validation_0-rmse:2.74610	validation_1-rmse:2.77871
[54]	validation_0-rmse:2.73804	validation_1-rmse:2.77052
[55]	validation_0-rmse:2.73509	validation_1-rmse:2.76821
[56]	validation_0-rmse:2.73102	validation_1-rmse:2.76451
[57]	validation_0-rmse:2.72034	validation_1-rmse:2.75388
[58]	validation_0-rmse:2.71092	validation_1-rmse:2.74506
[59]	validation_0-rmse:2.70841	validation_1-rmse:2.74295
[60]	validation_0-rmse:2.69791	validation_1-rmse:2.73288
[61]	validation_0-rmse:2.69095	validation_1-rmse:2.72714
[62]	validation_0-rmse:2.68135	validation_1-rmse:2.71867
[63]	validation_0-rmse:2.67210	validation_1-rmse:2.71069
[64]	validation_0-rmse:2.66064	validation_1-rmse:2.69993
[65]	validation_0-rmse:2.65686	validation_1-rmse:2.69675
[66]	validation_0-rmse:2.65339	validation_1-rmse:2.69361
[67]	validation_0-rmse:2.65111	validation_1-rmse:2.69171
[68]	validation_0-rmse:2.64703	validation_1-rmse:2.68788
[69]	validation_0-rmse:2.64558	validation_1-rmse:2.68693
[70]	validation_0-rmse:2.63956	validation_1-rmse:2.68067
[71]	validation_0-rmse:2.63666	validation_1-rmse:2.67823
[72]	validation_0-rmse:2.63157	validation_1-rmse:2.67347
[73]	validation_0-rmse:2.62285	validation_1-rmse:2.66493
[74]	validation_0-rmse:2.61587	validation_1-rmse:2.65843
[75]	validation_0-rmse:2.61307	validation_1-rmse:2.65569
[76]	validation_0-rmse:2.60566	validation_1-rmse:2.64817
[77]	validation_0-rmse:2.60309	validation_1-rmse:2.64595
[78]	validation_0-rmse:2.59975	validation_1-rmse:2.64233
[79]	validation_0-rmse:2.59370	validation_1-rmse:2.63659
[80]	validation_0-rmse:2.58436	validation_1-rmse:2.62717
[81]	validation_0-rmse:2.58200	validation_1-rmse:2.62519
[82]	validation_0-rmse:2.57705	validation_1-rmse:2.62099
[83]	validation_0-rmse:2.57327	validation_1-rmse:2.61724
[84]	validation_0-rmse:2.57105	validation_1-rmse:2.61563
[85]	validation_0-rmse:2.56582	validation_1-rmse:2.61099
[86]	validation_0-rmse:2.55513	validation_1-rmse:2.60008
[87]	validation_0-rmse:2.54374	validation_1-rmse:2.58885
[88]	validation_0-rmse:2.54233	validation_1-rmse:2.58759
[89]	validation_0-rmse:2.53871	validation_1-rmse:2.58421
[90]	validation_0-rmse:2.53577	validation_1-rmse:2.58207
[91]	validation_0-rmse:2.53088	validation_1-rmse:2.57712
[92]	validation_0-rmse:2.52473	validation_1-rmse:2.57202
[93]	validation_0-rmse:2.52004	validation_1-rmse:2.56763
[94]	validation_0-rmse:2.51528	validation_1-rmse:2.56314
[95]	validation_0-rmse:2.50887	validation_1-rmse:2.55733
[96]	validation_0-rmse:2.50365	validation_1-rmse:2.55295
[97]	validation_0-rmse:2.50067	validation_1-rmse:2.54996
[98]	validation_0-rmse:2.49661	validation_1-rmse:2.54629
[99]	validation_0-rmse:2.49457	validation_1-rmse:2.54497
[100]	validation_0-rmse:2.48729	validation_1-rmse:2.53775
[101]	validation_0-rmse:2.48316	validation_1-rmse:2.53423
[102]	validation_0-rmse:2.48020	validation_1-rmse:2.53168
[103]	validation_0-rmse:2.47656	validation_1-rmse:2.52803
[104]	validation_0-rmse:2.47240	validation_1-rmse:2.52393
[105]	validation_0-rmse:2.46718	validation_1-rmse:2.51853
[106]	validation_0-rmse:2.46228	validation_1-rmse:2.51399
[107]	validation_0-rmse:2.45853	validation_1-rmse:2.51089
[108]	validation_0-rmse:2.45472	validation_1-rmse:2.50730
[109]	validation_0-rmse:2.45023	validation_1-rmse:2.50296
[110]	validation_0-rmse:2.44504	validation_1-rmse:2.49780
[111]	validation_0-rmse:2.44352	validation_1-rmse:2.49629
[112]	validation_0-rmse:2.44002	validation_1-rmse:2.49312
[113]	validation_0-rmse:2.43876	validation_1-rmse:2.49193
[114]	validation_0-rmse:2.43220	validation_1-rmse:2.48530
[115]	validation_0-rmse:2.42923	validation_1-rmse:2.48345
[116]	validation_0-rmse:2.41894	validation_1-rmse:2.47392
[117]	validation_0-rmse:2.41734	validation_1-rmse:2.47278
[118]	validation_0-rmse:2.41239	validation_1-rmse:2.46820
[119]	validation_0-rmse:2.41007	validation_1-rmse:2.46636
[120]	validation_0-rmse:2.40490	validation_1-rmse:2.46177
[121]	validation_0-rmse:2.40300	validation_1-rmse:2.46006
[122]	validation_0-rmse:2.39906	validation_1-rmse:2.45600
[123]	validation_0-rmse:2.39722	validation_1-rmse:2.45472
[124]	validation_0-rmse:2.39473	validation_1-rmse:2.45271
[125]	validation_0-rmse:2.39135	validation_1-rmse:2.44945
[126]	validation_0-rmse:2.38988	validation_1-rmse:2.44831
[127]	validation_0-rmse:2.38324	validation_1-rmse:2.44165
[128]	validation_0-rmse:2.38161	validation_1-rmse:2.44072
[129]	validation_0-rmse:2.37884	validation_1-rmse:2.43776
[130]	validation_0-rmse:2.37392	validation_1-rmse:2.43291
[131]	validation_0-rmse:2.37317	validation_1-rmse:2.43222
[132]	validation_0-rmse:2.37174	validation_1-rmse:2.43126
[133]	validation_0-rmse:2.36664	validation_1-rmse:2.42613
[134]	validation_0-rmse:2.36477	validation_1-rmse:2.42442
[135]	validation_0-rmse:2.35922	validation_1-rmse:2.41917
[136]	validation_0-rmse:2.35043	validation_1-rmse:2.40994
[137]	validation_0-rmse:2.34734	validation_1-rmse:2.40713
[138]	validation_0-rmse:2.34533	validation_1-rmse:2.40553
[139]	validation_0-rmse:2.34061	validation_1-rmse:2.40068
[140]	validation_0-rmse:2.33758	validation_1-rmse:2.39778
[141]	validation_0-rmse:2.33568	validation_1-rmse:2.39629
[142]	validation_0-rmse:2.33142	validation_1-rmse:2.39261
[143]	validation_0-rmse:2.32932	validation_1-rmse:2.39054
[144]	validation_0-rmse:2.32321	validation_1-rmse:2.38485
[145]	validation_0-rmse:2.31962	validation_1-rmse:2.38172
[146]	validation_0-rmse:2.31583	validation_1-rmse:2.37809
[147]	validation_0-rmse:2.31237	validation_1-rmse:2.37501
[148]	validation_0-rmse:2.31072	validation_1-rmse:2.37359
[149]	validation_0-rmse:2.30688	validation_1-rmse:2.37009
[150]	validation_0-rmse:2.30103	validation_1-rmse:2.36521
[151]	validation_0-rmse:2.29831	validation_1-rmse:2.36269
[152]	validation_0-rmse:2.29444	validation_1-rmse:2.35896
[153]	validation_0-rmse:2.29114	validation_1-rmse:2.35616
[154]	validation_0-rmse:2.28637	validation_1-rmse:2.35165
[155]	validation_0-rmse:2.28292	validation_1-rmse:2.34771
[156]	validation_0-rmse:2.28069	validation_1-rmse:2.34600
[157]	validation_0-rmse:2.27521	validation_1-rmse:2.34095
[158]	validation_0-rmse:2.27384	validation_1-rmse:2.33987
[159]	validation_0-rmse:2.26943	validation_1-rmse:2.33551
[160]	validation_0-rmse:2.26598	validation_1-rmse:2.33228
[161]	validation_0-rmse:2.25980	validation_1-rmse:2.32588
[162]	validation_0-rmse:2.25836	validation_1-rmse:2.32471
[163]	validation_0-rmse:2.25530	validation_1-rmse:2.32181
[164]	validation_0-rmse:2.25391	validation_1-rmse:2.32087
[165]	validation_0-rmse:2.25051	validation_1-rmse:2.31784
[166]	validation_0-rmse:2.24704	validation_1-rmse:2.31428
[167]	validation_0-rmse:2.24581	validation_1-rmse:2.31338
[168]	validation_0-rmse:2.24393	validation_1-rmse:2.31141
[169]	validation_0-rmse:2.24139	validation_1-rmse:2.30913
[170]	validation_0-rmse:2.23857	validation_1-rmse:2.30650
[171]	validation_0-rmse:2.23603	validation_1-rmse:2.30434
[172]	validation_0-rmse:2.23229	validation_1-rmse:2.30092
[173]	validation_0-rmse:2.22849	validation_1-rmse:2.29751
[174]	validation_0-rmse:2.22675	validation_1-rmse:2.29616
[175]	validation_0-rmse:2.22459	validation_1-rmse:2.29419
[176]	validation_0-rmse:2.22417	validation_1-rmse:2.29409
[177]	validation_0-rmse:2.22060	validation_1-rmse:2.29056
[178]	validation_0-rmse:2.21892	validation_1-rmse:2.28887
[179]	validation_0-rmse:2.21472	validation_1-rmse:2.28452
[180]	validation_0-rmse:2.20998	validation_1-rmse:2.28005
[181]	validation_0-rmse:2.20814	validation_1-rmse:2.27847
[182]	validation_0-rmse:2.20685	validation_1-rmse:2.27768
[183]	validation_0-rmse:2.20411	validation_1-rmse:2.27504
[184]	validation_0-rmse:2.20153	validation_1-rmse:2.27298
[185]	validation_0-rmse:2.19662	validation_1-rmse:2.26866
[186]	validation_0-rmse:2.19405	validation_1-rmse:2.26580
[187]	validation_0-rmse:2.19116	validation_1-rmse:2.26280
[188]	validation_0-rmse:2.19044	validation_1-rmse:2.26244
[189]	validation_0-rmse:2.18880	validation_1-rmse:2.26112
[190]	validation_0-rmse:2.18468	validation_1-rmse:2.25734
[191]	validation_0-rmse:2.18270	validation_1-rmse:2.25616
[192]	validation_0-rmse:2.17877	validation_1-rmse:2.25249
[193]	validation_0-rmse:2.17785	validation_1-rmse:2.25191
[194]	validation_0-rmse:2.17661	validation_1-rmse:2.25093
[195]	validation_0-rmse:2.17381	validation_1-rmse:2.24812
[196]	validation_0-rmse:2.17243	validation_1-rmse:2.24725
[197]	validation_0-rmse:2.16911	validation_1-rmse:2.24422
[198]	validation_0-rmse:2.16474	validation_1-rmse:2.23995
[199]	validation_0-rmse:2.16383	validation_1-rmse:2.23936
&gt;&gt;&gt; Using model to predict target Ta_1_1_1 in unseen test data ...
&gt;&gt;&gt; Using model to calculate permutation importance based on unseen test data ...
&gt;&gt;&gt; Calculating prediction scores based on predicting unseen test data of Ta_1_1_1 ...
&gt;&gt;&gt; Collecting results, details about training and testing can be accessed by calling .report_traintest().
&gt;&gt;&gt; Done.

================================
MODEL TRAINING &amp; TESTING RESULTS
================================

## DATA
  &gt; target: Ta_1_1_1
  &gt; features: 12 [&#39;Rg_1_1_1_gfXG&#39;, &#39;SW_IN_POT&#39;, &#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.RECORDNUMBER&#39;]
  &gt; 350640 records (with missing)
  &gt; 350615 available records for target and all features (no missing values)
  &gt; training on 262961 records (75.0%) of 262961 features between 2005-01-01 01:00:00 and 2025-01-01 00:00:00
  &gt; testing on 87654 unseen records (25.0%) of Ta_1_1_1 between 2005-01-01 00:30:00 and 2024-12-31 20:00:00

## MODEL
  &gt; the model was trained on training data (262961 records)
  &gt; the model was tested on test data (87654 values)
  &gt; estimator:  XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=50,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=200, n_jobs=-1,
             num_parallel_tree=None, random_state=42, ...)
  &gt; parameters:  {&#39;objective&#39;: &#39;reg:squarederror&#39;, &#39;base_score&#39;: None, &#39;booster&#39;: None, &#39;callbacks&#39;: None, &#39;colsample_bylevel&#39;: None, &#39;colsample_bynode&#39;: None, &#39;colsample_bytree&#39;: None, &#39;device&#39;: None, &#39;early_stopping_rounds&#39;: 50, &#39;enable_categorical&#39;: False, &#39;eval_metric&#39;: None, &#39;feature_types&#39;: None, &#39;gamma&#39;: None, &#39;grow_policy&#39;: None, &#39;importance_type&#39;: None, &#39;interaction_constraints&#39;: None, &#39;learning_rate&#39;: None, &#39;max_bin&#39;: None, &#39;max_cat_threshold&#39;: None, &#39;max_cat_to_onehot&#39;: None, &#39;max_delta_step&#39;: None, &#39;max_depth&#39;: None, &#39;max_leaves&#39;: None, &#39;min_child_weight&#39;: None, &#39;missing&#39;: nan, &#39;monotone_constraints&#39;: None, &#39;multi_strategy&#39;: None, &#39;n_estimators&#39;: 200, &#39;n_jobs&#39;: -1, &#39;num_parallel_tree&#39;: None, &#39;random_state&#39;: 42, &#39;reg_alpha&#39;: None, &#39;reg_lambda&#39;: None, &#39;sampling_method&#39;: None, &#39;scale_pos_weight&#39;: None, &#39;subsample&#39;: None, &#39;tree_method&#39;: None, &#39;validate_parameters&#39;: None, &#39;verbosity&#39;: None}
  &gt; number of features used in model:  12
  &gt; names of features used in model:  [&#39;Rg_1_1_1_gfXG&#39;, &#39;SW_IN_POT&#39;, &#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.RECORDNUMBER&#39;]

## FEATURE IMPORTANCES
  &gt; feature importances were calculated based on unseen test data of Ta_1_1_1 (87654 records).
  &gt; feature importances are showing permutation importances from 10 repeats

               PERM_IMPORTANCE   PERM_SD
.DOY                  0.452190  0.001558
.SEASON               0.319004  0.002258
.YEARDOY              0.128633  0.000868
.HOUR                 0.127111  0.000852
Rg_1_1_1_gfXG         0.119204  0.000980
.RECORDNUMBER         0.103707  0.000464
.WEEK                 0.098638  0.000426
SW_IN_POT             0.080302  0.000247
.YEARMONTH            0.078782  0.000726
.YEARWEEK             0.073411  0.000513
.YEAR                 0.024057  0.000113
.MONTH                0.007748  0.000120


## MODEL SCORES
  All scores were calculated based on unseen test data (87654 records).
  &gt; MAE:  1.7429842239557976 (mean absolute error)
  &gt; MedAE:  1.422816740512848 (median absolute error)
  &gt; MSE:  5.014730498364737 (mean squared error)
  &gt; RMSE:  2.2393593946405157 (root mean squared error)
  &gt; MAXE:  16.771332221984864 (max error)
  &gt; MAPE:  331222274576.432 (mean absolute percentage error)
  &gt; R2:  0.9296376171760302
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span><span class="o">.</span><span class="n">fillgaps</span><span class="p">(</span><span class="n">showplot_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showplot_importance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xgb</span><span class="o">.</span><span class="n">report_gapfilling</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gap-filling using final model ...
&gt;&gt;&gt; Using final model on all data to predict target Ta_1_1_1 ...
&gt;&gt;&gt; Using final model on all data to calculate permutation importance ...
&gt;&gt;&gt; Calculating prediction scores based on all data predicting Ta_1_1_1 ...
&gt;&gt;&gt; Predicting target Ta_1_1_1 where all features are available ... predicted 350640 records.
&gt;&gt;&gt; Collecting results for final model ...
&gt;&gt;&gt; Filling 25 missing records in target with predictions from final model ...
&gt;&gt;&gt; Storing gap-filled time series in variable Ta_1_1_1_gfXG ...
&gt;&gt;&gt; Restoring original timestamp in results ...
&gt;&gt;&gt; Combining predictions from full model and fallback model ...

===================
GAP-FILLING RESULTS
===================

Model scores and feature importances were calculated from high-quality predicted targets (25 values, Ta_1_1_1_gfXG where flag=1) in comparison to observed targets (350615 values, Ta_1_1_1).

## TARGET
- first timestamp:  2005-01-01 00:30:00
- last timestamp:  2025-01-01 00:00:00
- potential number of values: 350640 values)
- target column (observed):  Ta_1_1_1
- missing records (observed):  25 (cross-check from flag: 25)
- target column (gap-filled):  Ta_1_1_1_gfXG  (350640 values)
- missing records (gap-filled):  0
- gap-filling flag: FLAG_Ta_1_1_1_gfXG_ISFILLED
  &gt; flag 0 ... observed targets (350615 values)
  &gt; flag 1 ... targets gap-filled with high-quality, all features available (25 values)
  &gt; flag 2 ... targets gap-filled with fallback (0 values)

## FEATURE IMPORTANCES
- names of features used in model:  [&#39;.DOY&#39;, &#39;.SEASON&#39;, &#39;.HOUR&#39;, &#39;.YEARDOY&#39;, &#39;Rg_1_1_1_gfXG&#39;, &#39;.RECORDNUMBER&#39;, &#39;.WEEK&#39;, &#39;SW_IN_POT&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARWEEK&#39;, &#39;.YEAR&#39;, &#39;.MONTH&#39;]
- number of features used in model:  12
- permutation importances were calculated from 10 repeats.

               PERM_IMPORTANCE   PERM_SD
.DOY                  0.451395  0.000868
.SEASON               0.316480  0.000674
.HOUR                 0.128810  0.000402
.YEARDOY              0.128808  0.000256
Rg_1_1_1_gfXG         0.120943  0.000261
.RECORDNUMBER         0.104971  0.000182
.WEEK                 0.098343  0.000324
SW_IN_POT             0.081348  0.000156
.YEARMONTH            0.079435  0.000169
.YEARWEEK             0.074375  0.000302
.YEAR                 0.023999  0.000075
.MONTH                0.007819  0.000043

## MODEL
The model was trained on a training set with test size 25.00%.
- estimator:  XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=50,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=200, n_jobs=-1,
             num_parallel_tree=None, random_state=42, ...)
- parameters:  {&#39;objective&#39;: &#39;reg:squarederror&#39;, &#39;base_score&#39;: None, &#39;booster&#39;: None, &#39;callbacks&#39;: None, &#39;colsample_bylevel&#39;: None, &#39;colsample_bynode&#39;: None, &#39;colsample_bytree&#39;: None, &#39;device&#39;: None, &#39;early_stopping_rounds&#39;: 50, &#39;enable_categorical&#39;: False, &#39;eval_metric&#39;: None, &#39;feature_types&#39;: None, &#39;gamma&#39;: None, &#39;grow_policy&#39;: None, &#39;importance_type&#39;: None, &#39;interaction_constraints&#39;: None, &#39;learning_rate&#39;: None, &#39;max_bin&#39;: None, &#39;max_cat_threshold&#39;: None, &#39;max_cat_to_onehot&#39;: None, &#39;max_delta_step&#39;: None, &#39;max_depth&#39;: None, &#39;max_leaves&#39;: None, &#39;min_child_weight&#39;: None, &#39;missing&#39;: nan, &#39;monotone_constraints&#39;: None, &#39;multi_strategy&#39;: None, &#39;n_estimators&#39;: 200, &#39;n_jobs&#39;: -1, &#39;num_parallel_tree&#39;: None, &#39;random_state&#39;: 42, &#39;reg_alpha&#39;: None, &#39;reg_lambda&#39;: None, &#39;sampling_method&#39;: None, &#39;scale_pos_weight&#39;: None, &#39;subsample&#39;: None, &#39;tree_method&#39;: None, &#39;validate_parameters&#39;: None, &#39;verbosity&#39;: None}

## MODEL SCORES
- MAE:  1.6963411027396023 (mean absolute error)
- MedAE:  1.3797559890747078 (median absolute error)
- MSE:  4.765300095818487 (mean squared error)
- RMSE:  2.182956732465966 (root mean squared error)
- MAXE:  16.771332221984864 (max error)
- MAPE:  389002735184.657 (mean absolute percentage error)
- R2:  0.9331971062782249
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observed</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">]</span>
<span class="n">gapfilled</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">get_gapfilled_target</span><span class="p">()</span>
<span class="n">data_simple_merged</span><span class="p">[</span><span class="n">gapfilled</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">gapfilled</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Air temperature&quot;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">TimeSeries</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">gapfilled</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">TimeSeries</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># ax.set_ylim(-2000, 200)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/264d2b216377efa07e94b68bacca0f4653ccb06e6d4e12e8002c7bf4ca0869e1.png" src="../_images/264d2b216377efa07e94b68bacca0f4653ccb06e6d4e12e8002c7bf4ca0869e1.png" />
</div>
</div>
</section>
<section id="ppfd">
<h2>PPFD<a class="headerlink" href="#ppfd" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[[</span><span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[[</span><span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;SW_IN_POT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">potrad</span><span class="p">(</span><span class="n">timestamp_index</span><span class="o">=</span><span class="n">_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                          <span class="n">lat</span><span class="o">=</span><span class="mf">47.210227</span><span class="p">,</span>  <span class="c1"># CH-CHA</span>
                          <span class="n">lon</span><span class="o">=</span><span class="mf">8.410645</span><span class="p">,</span>  <span class="c1"># CH-CHA</span>
                          <span class="n">utc_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PPFD_1_1_1</th>
      <th>Rg_1_1_1_gfXG</th>
      <th>SW_IN_POT</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span> <span class="o">=</span> <span class="n">XGBoostTS</span><span class="p">(</span>
    <span class="n">input_df</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
    <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">,</span>
    <span class="n">perm_n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">include_timestamp_as_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_continuous_record_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adding new data columns ...
++ Added new columns with timestamp info: [&#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;] 
++ Added new column .RECORDNUMBER with record numbers from 1 to 350640.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span><span class="o">.</span><span class="n">trainmodel</span><span class="p">(</span><span class="n">showplot_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showplot_importance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xgb</span><span class="o">.</span><span class="n">report_traintest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training final model ...
&gt;&gt;&gt; Training model &lt;class &#39;xgboost.sklearn.XGBRegressor&#39;&gt; based on data between 2005-09-09 10:30:00 and 2024-12-31 23:30:00 ...
&gt;&gt;&gt; Fitting model to training data ...
[0]	validation_0-rmse:326.27551	validation_1-rmse:325.35112
[1]	validation_0-rmse:229.15994	validation_1-rmse:228.41418
[2]	validation_0-rmse:161.39186	validation_1-rmse:160.74835
[3]	validation_0-rmse:114.25617	validation_1-rmse:113.65303
[4]	validation_0-rmse:81.65777	validation_1-rmse:81.10705
[5]	validation_0-rmse:59.34811	validation_1-rmse:58.79729
[6]	validation_0-rmse:44.34227	validation_1-rmse:43.82627
[7]	validation_0-rmse:34.53873	validation_1-rmse:34.02278
[8]	validation_0-rmse:28.32398	validation_1-rmse:27.79675
[9]	validation_0-rmse:24.54367	validation_1-rmse:24.03895
[10]	validation_0-rmse:22.28900	validation_1-rmse:21.79923
[11]	validation_0-rmse:20.92441	validation_1-rmse:20.45497
[12]	validation_0-rmse:20.08053	validation_1-rmse:19.65291
[13]	validation_0-rmse:19.46727	validation_1-rmse:19.09703
[14]	validation_0-rmse:19.05200	validation_1-rmse:18.70585
[15]	validation_0-rmse:18.71108	validation_1-rmse:18.37616
[16]	validation_0-rmse:18.51858	validation_1-rmse:18.20425
[17]	validation_0-rmse:18.26462	validation_1-rmse:17.98407
[18]	validation_0-rmse:17.97508	validation_1-rmse:17.74810
[19]	validation_0-rmse:17.83096	validation_1-rmse:17.60330
[20]	validation_0-rmse:17.70241	validation_1-rmse:17.49796
[21]	validation_0-rmse:17.54577	validation_1-rmse:17.37214
[22]	validation_0-rmse:17.48125	validation_1-rmse:17.31591
[23]	validation_0-rmse:17.38872	validation_1-rmse:17.27660
[24]	validation_0-rmse:17.27775	validation_1-rmse:17.18027
[25]	validation_0-rmse:16.97466	validation_1-rmse:16.96618
[26]	validation_0-rmse:16.91879	validation_1-rmse:16.92453
[27]	validation_0-rmse:16.87375	validation_1-rmse:16.89618
[28]	validation_0-rmse:16.81788	validation_1-rmse:16.87191
[29]	validation_0-rmse:16.61309	validation_1-rmse:16.66660
[30]	validation_0-rmse:16.58299	validation_1-rmse:16.64544
[31]	validation_0-rmse:16.52658	validation_1-rmse:16.59307
[32]	validation_0-rmse:16.44161	validation_1-rmse:16.52907
[33]	validation_0-rmse:16.40901	validation_1-rmse:16.52146
[34]	validation_0-rmse:16.35332	validation_1-rmse:16.47343
[35]	validation_0-rmse:16.30996	validation_1-rmse:16.44538
[36]	validation_0-rmse:16.26668	validation_1-rmse:16.41385
[37]	validation_0-rmse:16.24255	validation_1-rmse:16.40039
[38]	validation_0-rmse:16.19985	validation_1-rmse:16.37340
[39]	validation_0-rmse:16.16997	validation_1-rmse:16.35382
[40]	validation_0-rmse:16.11048	validation_1-rmse:16.31108
[41]	validation_0-rmse:16.00353	validation_1-rmse:16.24386
[42]	validation_0-rmse:15.97877	validation_1-rmse:16.22847
[43]	validation_0-rmse:15.95932	validation_1-rmse:16.21812
[44]	validation_0-rmse:15.89171	validation_1-rmse:16.17601
[45]	validation_0-rmse:15.84993	validation_1-rmse:16.14658
[46]	validation_0-rmse:15.81628	validation_1-rmse:16.11557
[47]	validation_0-rmse:15.78536	validation_1-rmse:16.10603
[48]	validation_0-rmse:15.72815	validation_1-rmse:16.09723
[49]	validation_0-rmse:15.70267	validation_1-rmse:16.08834
[50]	validation_0-rmse:15.68380	validation_1-rmse:16.07877
[51]	validation_0-rmse:15.65415	validation_1-rmse:16.06470
[52]	validation_0-rmse:15.59857	validation_1-rmse:16.03258
[53]	validation_0-rmse:15.57342	validation_1-rmse:16.02852
[54]	validation_0-rmse:15.55798	validation_1-rmse:16.01866
[55]	validation_0-rmse:15.53373	validation_1-rmse:16.00996
[56]	validation_0-rmse:15.51845	validation_1-rmse:16.00235
[57]	validation_0-rmse:15.47137	validation_1-rmse:15.96938
[58]	validation_0-rmse:15.45522	validation_1-rmse:15.96823
[59]	validation_0-rmse:15.44228	validation_1-rmse:15.96030
[60]	validation_0-rmse:15.41343	validation_1-rmse:15.93805
[61]	validation_0-rmse:15.36426	validation_1-rmse:15.92493
[62]	validation_0-rmse:15.32046	validation_1-rmse:15.92396
[63]	validation_0-rmse:15.30136	validation_1-rmse:15.91055
[64]	validation_0-rmse:15.29032	validation_1-rmse:15.90250
[65]	validation_0-rmse:15.26648	validation_1-rmse:15.89080
[66]	validation_0-rmse:15.23583	validation_1-rmse:15.88046
[67]	validation_0-rmse:15.20186	validation_1-rmse:15.87016
[68]	validation_0-rmse:15.18144	validation_1-rmse:15.85648
[69]	validation_0-rmse:15.14877	validation_1-rmse:15.81780
[70]	validation_0-rmse:15.10602	validation_1-rmse:15.81624
[71]	validation_0-rmse:15.08676	validation_1-rmse:15.80063
[72]	validation_0-rmse:15.07764	validation_1-rmse:15.79461
[73]	validation_0-rmse:14.99775	validation_1-rmse:15.80333
[74]	validation_0-rmse:14.96204	validation_1-rmse:15.80409
[75]	validation_0-rmse:14.93371	validation_1-rmse:15.78970
[76]	validation_0-rmse:14.90269	validation_1-rmse:15.77501
[77]	validation_0-rmse:14.87431	validation_1-rmse:15.77070
[78]	validation_0-rmse:14.82716	validation_1-rmse:15.73402
[79]	validation_0-rmse:14.80354	validation_1-rmse:15.72120
[80]	validation_0-rmse:14.79135	validation_1-rmse:15.71466
[81]	validation_0-rmse:14.77830	validation_1-rmse:15.70640
[82]	validation_0-rmse:14.72622	validation_1-rmse:15.69495
[83]	validation_0-rmse:14.68460	validation_1-rmse:15.69889
[84]	validation_0-rmse:14.62477	validation_1-rmse:15.67340
[85]	validation_0-rmse:14.61104	validation_1-rmse:15.66271
[86]	validation_0-rmse:14.57446	validation_1-rmse:15.65621
[87]	validation_0-rmse:14.54018	validation_1-rmse:15.65460
[88]	validation_0-rmse:14.51565	validation_1-rmse:15.62688
[89]	validation_0-rmse:14.50019	validation_1-rmse:15.61825
[90]	validation_0-rmse:14.47106	validation_1-rmse:15.60940
[91]	validation_0-rmse:14.42660	validation_1-rmse:15.58091
[92]	validation_0-rmse:14.39726	validation_1-rmse:15.56069
[93]	validation_0-rmse:14.38705	validation_1-rmse:15.55546
[94]	validation_0-rmse:14.37140	validation_1-rmse:15.54472
[95]	validation_0-rmse:14.36043	validation_1-rmse:15.53281
[96]	validation_0-rmse:14.33084	validation_1-rmse:15.50666
[97]	validation_0-rmse:14.31190	validation_1-rmse:15.50588
[98]	validation_0-rmse:14.29762	validation_1-rmse:15.49522
[99]	validation_0-rmse:14.27596	validation_1-rmse:15.48771
[100]	validation_0-rmse:14.22774	validation_1-rmse:15.47246
[101]	validation_0-rmse:14.21919	validation_1-rmse:15.46633
[102]	validation_0-rmse:14.21297	validation_1-rmse:15.46225
[103]	validation_0-rmse:14.14901	validation_1-rmse:15.44763
[104]	validation_0-rmse:14.12583	validation_1-rmse:15.44971
[105]	validation_0-rmse:14.10470	validation_1-rmse:15.44074
[106]	validation_0-rmse:14.07633	validation_1-rmse:15.42604
[107]	validation_0-rmse:14.06554	validation_1-rmse:15.42123
[108]	validation_0-rmse:14.00942	validation_1-rmse:15.43524
[109]	validation_0-rmse:13.99141	validation_1-rmse:15.42885
[110]	validation_0-rmse:13.96815	validation_1-rmse:15.41466
[111]	validation_0-rmse:13.96310	validation_1-rmse:15.41378
[112]	validation_0-rmse:13.95637	validation_1-rmse:15.40895
[113]	validation_0-rmse:13.91870	validation_1-rmse:15.42154
[114]	validation_0-rmse:13.88669	validation_1-rmse:15.41908
[115]	validation_0-rmse:13.87378	validation_1-rmse:15.41114
[116]	validation_0-rmse:13.85976	validation_1-rmse:15.40016
[117]	validation_0-rmse:13.81723	validation_1-rmse:15.40116
[118]	validation_0-rmse:13.79300	validation_1-rmse:15.39608
[119]	validation_0-rmse:13.75834	validation_1-rmse:15.39748
[120]	validation_0-rmse:13.71331	validation_1-rmse:15.39523
[121]	validation_0-rmse:13.70257	validation_1-rmse:15.39042
[122]	validation_0-rmse:13.68746	validation_1-rmse:15.37988
[123]	validation_0-rmse:13.65988	validation_1-rmse:15.36843
[124]	validation_0-rmse:13.63459	validation_1-rmse:15.36158
[125]	validation_0-rmse:13.56089	validation_1-rmse:15.36198
[126]	validation_0-rmse:13.54462	validation_1-rmse:15.36276
[127]	validation_0-rmse:13.53419	validation_1-rmse:15.35573
[128]	validation_0-rmse:13.51080	validation_1-rmse:15.35536
[129]	validation_0-rmse:13.49005	validation_1-rmse:15.35905
[130]	validation_0-rmse:13.47284	validation_1-rmse:15.34280
[131]	validation_0-rmse:13.46768	validation_1-rmse:15.33950
[132]	validation_0-rmse:13.45243	validation_1-rmse:15.32583
[133]	validation_0-rmse:13.44265	validation_1-rmse:15.32092
[134]	validation_0-rmse:13.42436	validation_1-rmse:15.30797
[135]	validation_0-rmse:13.40412	validation_1-rmse:15.30556
[136]	validation_0-rmse:13.39399	validation_1-rmse:15.30310
[137]	validation_0-rmse:13.36496	validation_1-rmse:15.30411
[138]	validation_0-rmse:13.34034	validation_1-rmse:15.30419
[139]	validation_0-rmse:13.32625	validation_1-rmse:15.30645
[140]	validation_0-rmse:13.30911	validation_1-rmse:15.29381
[141]	validation_0-rmse:13.29550	validation_1-rmse:15.28830
[142]	validation_0-rmse:13.25221	validation_1-rmse:15.29054
[143]	validation_0-rmse:13.20734	validation_1-rmse:15.29670
[144]	validation_0-rmse:13.18773	validation_1-rmse:15.30614
[145]	validation_0-rmse:13.17769	validation_1-rmse:15.30926
[146]	validation_0-rmse:13.16630	validation_1-rmse:15.30394
[147]	validation_0-rmse:13.13977	validation_1-rmse:15.28965
[148]	validation_0-rmse:13.12337	validation_1-rmse:15.29156
[149]	validation_0-rmse:13.11185	validation_1-rmse:15.29233
[150]	validation_0-rmse:13.09277	validation_1-rmse:15.29233
[151]	validation_0-rmse:13.06347	validation_1-rmse:15.27425
[152]	validation_0-rmse:13.04847	validation_1-rmse:15.26449
[153]	validation_0-rmse:13.01694	validation_1-rmse:15.25813
[154]	validation_0-rmse:13.00040	validation_1-rmse:15.25474
[155]	validation_0-rmse:12.98252	validation_1-rmse:15.25217
[156]	validation_0-rmse:12.96236	validation_1-rmse:15.25570
[157]	validation_0-rmse:12.94877	validation_1-rmse:15.24609
[158]	validation_0-rmse:12.93836	validation_1-rmse:15.24130
[159]	validation_0-rmse:12.92006	validation_1-rmse:15.23677
[160]	validation_0-rmse:12.90965	validation_1-rmse:15.23954
[161]	validation_0-rmse:12.88600	validation_1-rmse:15.23005
[162]	validation_0-rmse:12.87593	validation_1-rmse:15.22526
[163]	validation_0-rmse:12.86321	validation_1-rmse:15.22188
[164]	validation_0-rmse:12.85278	validation_1-rmse:15.22139
[165]	validation_0-rmse:12.84512	validation_1-rmse:15.21839
[166]	validation_0-rmse:12.82347	validation_1-rmse:15.22781
[167]	validation_0-rmse:12.80784	validation_1-rmse:15.21849
[168]	validation_0-rmse:12.77928	validation_1-rmse:15.21652
[169]	validation_0-rmse:12.76781	validation_1-rmse:15.21334
[170]	validation_0-rmse:12.73565	validation_1-rmse:15.20818
[171]	validation_0-rmse:12.72541	validation_1-rmse:15.20143
[172]	validation_0-rmse:12.71790	validation_1-rmse:15.19861
[173]	validation_0-rmse:12.70541	validation_1-rmse:15.19197
[174]	validation_0-rmse:12.67511	validation_1-rmse:15.18518
[175]	validation_0-rmse:12.65295	validation_1-rmse:15.17695
[176]	validation_0-rmse:12.62494	validation_1-rmse:15.17436
[177]	validation_0-rmse:12.62194	validation_1-rmse:15.17409
[178]	validation_0-rmse:12.61613	validation_1-rmse:15.17053
[179]	validation_0-rmse:12.60785	validation_1-rmse:15.16622
[180]	validation_0-rmse:12.58622	validation_1-rmse:15.17315
[181]	validation_0-rmse:12.55518	validation_1-rmse:15.17834
[182]	validation_0-rmse:12.53581	validation_1-rmse:15.17265
[183]	validation_0-rmse:12.51571	validation_1-rmse:15.16706
[184]	validation_0-rmse:12.49357	validation_1-rmse:15.15927
[185]	validation_0-rmse:12.47650	validation_1-rmse:15.16129
[186]	validation_0-rmse:12.45581	validation_1-rmse:15.14889
[187]	validation_0-rmse:12.45232	validation_1-rmse:15.14706
[188]	validation_0-rmse:12.42458	validation_1-rmse:15.15675
[189]	validation_0-rmse:12.41472	validation_1-rmse:15.15322
[190]	validation_0-rmse:12.40917	validation_1-rmse:15.14992
[191]	validation_0-rmse:12.39557	validation_1-rmse:15.14990
[192]	validation_0-rmse:12.37586	validation_1-rmse:15.15011
[193]	validation_0-rmse:12.36523	validation_1-rmse:15.14715
[194]	validation_0-rmse:12.35525	validation_1-rmse:15.14406
[195]	validation_0-rmse:12.34698	validation_1-rmse:15.14295
[196]	validation_0-rmse:12.33852	validation_1-rmse:15.13995
[197]	validation_0-rmse:12.33182	validation_1-rmse:15.13401
[198]	validation_0-rmse:12.32886	validation_1-rmse:15.13454
[199]	validation_0-rmse:12.29812	validation_1-rmse:15.12184
&gt;&gt;&gt; Using model to predict target PPFD_1_1_1 in unseen test data ...
&gt;&gt;&gt; Using model to calculate permutation importance based on unseen test data ...
&gt;&gt;&gt; Calculating prediction scores based on predicting unseen test data of PPFD_1_1_1 ...
&gt;&gt;&gt; Collecting results, details about training and testing can be accessed by calling .report_traintest().
&gt;&gt;&gt; Done.

================================
MODEL TRAINING &amp; TESTING RESULTS
================================

## DATA
  &gt; target: PPFD_1_1_1
  &gt; features: 12 [&#39;Rg_1_1_1_gfXG&#39;, &#39;SW_IN_POT&#39;, &#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.RECORDNUMBER&#39;]
  &gt; 350640 records (with missing)
  &gt; 333952 available records for target and all features (no missing values)
  &gt; training on 250464 records (75.0%) of 250464 features between 2005-09-09 10:30:00 and 2024-12-31 23:30:00
  &gt; testing on 83488 unseen records (25.0%) of PPFD_1_1_1 between 2005-09-09 10:00:00 and 2025-01-01 00:00:00

## MODEL
  &gt; the model was trained on training data (250464 records)
  &gt; the model was tested on test data (83488 values)
  &gt; estimator:  XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=50,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=200, n_jobs=-1,
             num_parallel_tree=None, random_state=42, ...)
  &gt; parameters:  {&#39;objective&#39;: &#39;reg:squarederror&#39;, &#39;base_score&#39;: None, &#39;booster&#39;: None, &#39;callbacks&#39;: None, &#39;colsample_bylevel&#39;: None, &#39;colsample_bynode&#39;: None, &#39;colsample_bytree&#39;: None, &#39;device&#39;: None, &#39;early_stopping_rounds&#39;: 50, &#39;enable_categorical&#39;: False, &#39;eval_metric&#39;: None, &#39;feature_types&#39;: None, &#39;gamma&#39;: None, &#39;grow_policy&#39;: None, &#39;importance_type&#39;: None, &#39;interaction_constraints&#39;: None, &#39;learning_rate&#39;: None, &#39;max_bin&#39;: None, &#39;max_cat_threshold&#39;: None, &#39;max_cat_to_onehot&#39;: None, &#39;max_delta_step&#39;: None, &#39;max_depth&#39;: None, &#39;max_leaves&#39;: None, &#39;min_child_weight&#39;: None, &#39;missing&#39;: nan, &#39;monotone_constraints&#39;: None, &#39;multi_strategy&#39;: None, &#39;n_estimators&#39;: 200, &#39;n_jobs&#39;: -1, &#39;num_parallel_tree&#39;: None, &#39;random_state&#39;: 42, &#39;reg_alpha&#39;: None, &#39;reg_lambda&#39;: None, &#39;sampling_method&#39;: None, &#39;scale_pos_weight&#39;: None, &#39;subsample&#39;: None, &#39;tree_method&#39;: None, &#39;validate_parameters&#39;: None, &#39;verbosity&#39;: None}
  &gt; number of features used in model:  12
  &gt; names of features used in model:  [&#39;Rg_1_1_1_gfXG&#39;, &#39;SW_IN_POT&#39;, &#39;.YEAR&#39;, &#39;.SEASON&#39;, &#39;.MONTH&#39;, &#39;.WEEK&#39;, &#39;.DOY&#39;, &#39;.HOUR&#39;, &#39;.YEARMONTH&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.RECORDNUMBER&#39;]

## FEATURE IMPORTANCES
  &gt; feature importances were calculated based on unseen test data of PPFD_1_1_1 (83488 records).
  &gt; feature importances are showing permutation importances from 10 repeats

               PERM_IMPORTANCE   PERM_SD
Rg_1_1_1_gfXG         1.816817  0.005574
SW_IN_POT             0.007734  0.000031
.DOY                  0.001268  0.000021
.RECORDNUMBER         0.000885  0.000011
.YEARDOY              0.000813  0.000026
.YEARWEEK             0.000702  0.000014
.YEARMONTH            0.000609  0.000014
.HOUR                 0.000449  0.000012
.WEEK                 0.000217  0.000014
.YEAR                 0.000141  0.000009
.MONTH                0.000054  0.000004
.SEASON               0.000022  0.000003


## MODEL SCORES
  All scores were calculated based on unseen test data (83488 records).
  &gt; MAE:  5.949002945270418 (mean absolute error)
  &gt; MedAE:  1.342175379584503 (median absolute error)
  &gt; MSE:  228.67013676612885 (mean squared error)
  &gt; RMSE:  15.121843034700792 (root mean squared error)
  &gt; MAXE:  1109.3961547851563 (max error)
  &gt; MAPE:  364191942296506.250 (mean absolute percentage error)
  &gt; R2:  0.9989382096126932
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb</span><span class="o">.</span><span class="n">fillgaps</span><span class="p">(</span><span class="n">showplot_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showplot_importance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xgb</span><span class="o">.</span><span class="n">report_gapfilling</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gap-filling using final model ...
&gt;&gt;&gt; Using final model on all data to predict target PPFD_1_1_1 ...
&gt;&gt;&gt; Using final model on all data to calculate permutation importance ...
&gt;&gt;&gt; Calculating prediction scores based on all data predicting PPFD_1_1_1 ...
&gt;&gt;&gt; Predicting target PPFD_1_1_1 where all features are available ... predicted 350640 records.
&gt;&gt;&gt; Collecting results for final model ...
&gt;&gt;&gt; Filling 16688 missing records in target with predictions from final model ...
&gt;&gt;&gt; Storing gap-filled time series in variable PPFD_1_1_1_gfXG ...
&gt;&gt;&gt; Restoring original timestamp in results ...
&gt;&gt;&gt; Combining predictions from full model and fallback model ...

===================
GAP-FILLING RESULTS
===================

Model scores and feature importances were calculated from high-quality predicted targets (16688 values, PPFD_1_1_1_gfXG where flag=1) in comparison to observed targets (333952 values, PPFD_1_1_1).

## TARGET
- first timestamp:  2005-01-01 00:30:00
- last timestamp:  2025-01-01 00:00:00
- potential number of values: 350640 values)
- target column (observed):  PPFD_1_1_1
- missing records (observed):  16688 (cross-check from flag: 16688)
- target column (gap-filled):  PPFD_1_1_1_gfXG  (350640 values)
- missing records (gap-filled):  0
- gap-filling flag: FLAG_PPFD_1_1_1_gfXG_ISFILLED
  &gt; flag 0 ... observed targets (333952 values)
  &gt; flag 1 ... targets gap-filled with high-quality, all features available (16688 values)
  &gt; flag 2 ... targets gap-filled with fallback (0 values)

## FEATURE IMPORTANCES
- names of features used in model:  [&#39;Rg_1_1_1_gfXG&#39;, &#39;SW_IN_POT&#39;, &#39;.DOY&#39;, &#39;.RECORDNUMBER&#39;, &#39;.YEARDOY&#39;, &#39;.YEARWEEK&#39;, &#39;.YEARMONTH&#39;, &#39;.HOUR&#39;, &#39;.WEEK&#39;, &#39;.YEAR&#39;, &#39;.MONTH&#39;, &#39;.SEASON&#39;]
- number of features used in model:  12
- permutation importances were calculated from 10 repeats.

               PERM_IMPORTANCE       PERM_SD
Rg_1_1_1_gfXG         1.815585  2.659631e-03
SW_IN_POT             0.008115  3.968138e-05
.DOY                  0.001392  1.291645e-05
.RECORDNUMBER         0.000920  8.175547e-06
.YEARDOY              0.000855  9.268730e-06
.YEARWEEK             0.000771  4.814868e-06
.YEARMONTH            0.000648  5.725777e-06
.HOUR                 0.000505  6.688846e-06
.WEEK                 0.000243  4.858794e-06
.YEAR                 0.000197  3.421291e-06
.MONTH                0.000059  2.071061e-06
.SEASON               0.000025  6.999240e-07

## MODEL
The model was trained on a training set with test size 25.00%.
- estimator:  XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=50,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=None, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=200, n_jobs=-1,
             num_parallel_tree=None, random_state=42, ...)
- parameters:  {&#39;objective&#39;: &#39;reg:squarederror&#39;, &#39;base_score&#39;: None, &#39;booster&#39;: None, &#39;callbacks&#39;: None, &#39;colsample_bylevel&#39;: None, &#39;colsample_bynode&#39;: None, &#39;colsample_bytree&#39;: None, &#39;device&#39;: None, &#39;early_stopping_rounds&#39;: 50, &#39;enable_categorical&#39;: False, &#39;eval_metric&#39;: None, &#39;feature_types&#39;: None, &#39;gamma&#39;: None, &#39;grow_policy&#39;: None, &#39;importance_type&#39;: None, &#39;interaction_constraints&#39;: None, &#39;learning_rate&#39;: None, &#39;max_bin&#39;: None, &#39;max_cat_threshold&#39;: None, &#39;max_cat_to_onehot&#39;: None, &#39;max_delta_step&#39;: None, &#39;max_depth&#39;: None, &#39;max_leaves&#39;: None, &#39;min_child_weight&#39;: None, &#39;missing&#39;: nan, &#39;monotone_constraints&#39;: None, &#39;multi_strategy&#39;: None, &#39;n_estimators&#39;: 200, &#39;n_jobs&#39;: -1, &#39;num_parallel_tree&#39;: None, &#39;random_state&#39;: 42, &#39;reg_alpha&#39;: None, &#39;reg_lambda&#39;: None, &#39;sampling_method&#39;: None, &#39;scale_pos_weight&#39;: None, &#39;subsample&#39;: None, &#39;tree_method&#39;: None, &#39;validate_parameters&#39;: None, &#39;verbosity&#39;: None}

## MODEL SCORES
- MAE:  5.456275166305183 (mean absolute error)
- MedAE:  1.3037166595458984 (median absolute error)
- MSE:  170.60041608006205 (mean squared error)
- RMSE:  13.061409421653623 (root mean squared error)
- MAXE:  1109.3961547851563 (max error)
- MAPE:  361749035722459.625 (mean absolute percentage error)
- R2:  0.9992106955957651
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observed</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">]</span>
<span class="n">gapfilled</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">get_gapfilled_target</span><span class="p">()</span>
<span class="n">data_simple_merged</span><span class="p">[</span><span class="n">gapfilled</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">gapfilled</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;PPFD&quot;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">TimeSeries</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">gapfilled</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">TimeSeries</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># ax.set_ylim(-2000, 200)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fa84380fde0b719e081cae59522e689066ac5837975e57df28be6d38e6921aaf.png" src="../_images/fa84380fde0b719e081cae59522e689066ac5837975e57df28be6d38e6921aaf.png" />
</div>
</div>
</br></section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plots">
<h1><strong>Plots</strong><a class="headerlink" href="#plots" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_plot_df</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[[</span><span class="s1">&#39;Lwin_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD_1_1_1_gfXG&#39;</span><span class="p">,</span> <span class="s1">&#39;RH_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">,</span> <span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ta_1_1_1_gfXG&#39;</span><span class="p">,</span> <span class="s1">&#39;Pa_1_1_1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_plot_df</span> <span class="o">=</span> <span class="n">_plot_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="time-series-plot">
<h2>Time series plot<a class="headerlink" href="#time-series-plot" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_plot_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Downloaded data&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">x_compat</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/abb682be68258cc1fa54461378c527a5920615931a4141d0ae43667b8fa265a7.png" src="../_images/abb682be68258cc1fa54461378c527a5920615931a4141d0ae43667b8fa265a7.png" />
</div>
</div>
</section>
<section id="heatmaps">
<h2>Heatmaps<a class="headerlink" href="#heatmaps" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">_plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>    
    <span class="n">series</span> <span class="o">=</span> <span class="n">_plot_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">col</span>
    <span class="n">HeatmapDateTime</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c0c16079dcba025ca30e5f3fcec39bb74959b83f64cfd42437ce8870c4ad77be.png" src="../_images/c0c16079dcba025ca30e5f3fcec39bb74959b83f64cfd42437ce8870c4ad77be.png" />
<img alt="../_images/5b8749446a3f92c472ebd23bacacaeb5b08acab193032d6145e16696c92d1b58.png" src="../_images/5b8749446a3f92c472ebd23bacacaeb5b08acab193032d6145e16696c92d1b58.png" />
<img alt="../_images/25efef70b6f18b7b1633c2dd686e2c56b0b04d9bf9a81bfdaf5554a1a1e8e19d.png" src="../_images/25efef70b6f18b7b1633c2dd686e2c56b0b04d9bf9a81bfdaf5554a1a1e8e19d.png" />
<img alt="../_images/1c41cc730c982e145dfeb949efa55dc4757502f1e3057bdbd3ae353c766dcd8b.png" src="../_images/1c41cc730c982e145dfeb949efa55dc4757502f1e3057bdbd3ae353c766dcd8b.png" />
<img alt="../_images/4ca7ef4b40ca09b834c80267dc22178453916d79a3ed38035373588adf366c16.png" src="../_images/4ca7ef4b40ca09b834c80267dc22178453916d79a3ed38035373588adf366c16.png" />
<img alt="../_images/17e53672e6e939eca18fd80523df37e44cedb4e57d37bb5872188c652fe7c5d0.png" src="../_images/17e53672e6e939eca18fd80523df37e44cedb4e57d37bb5872188c652fe7c5d0.png" />
<img alt="../_images/f1012661f3025da2b5529936fe78282b101019231fdb58fa56bb02ac09c2812c.png" src="../_images/f1012661f3025da2b5529936fe78282b101019231fdb58fa56bb02ac09c2812c.png" />
<img alt="../_images/65a2e3ce17a0d4a6171396019bc820ada14192b7379e4c67bed8ea1aa6842a17.png" src="../_images/65a2e3ce17a0d4a6171396019bc820ada14192b7379e4c67bed8ea1aa6842a17.png" />
<img alt="../_images/92fc0e2ecf17d6ce4fbf1c0cb07a61194edd1f4e6d6074c746eb571d8f60ab2d.png" src="../_images/92fc0e2ecf17d6ce4fbf1c0cb07a61194edd1f4e6d6074c746eb571d8f60ab2d.png" />
</div>
</div>
</br></section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stats">
<h1><strong>Stats</strong><a class="headerlink" href="#stats" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_simple_merged</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lwin_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>PPFD_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
      <th>Rg_1_1_1_gfXG</th>
      <th>Ta_1_1_1_gfXG</th>
      <th>PPFD_1_1_1_gfXG</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>350627.000000</td>
      <td>350625.000000</td>
      <td>333952.000000</td>
      <td>282149.000000</td>
      <td>350627.000000</td>
      <td>350615.000000</td>
      <td>350640.000000</td>
      <td>350640.000000</td>
      <td>350640.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>323.490219</td>
      <td>97.086400</td>
      <td>279.286305</td>
      <td>85.712083</td>
      <td>141.965870</td>
      <td>9.935086</td>
      <td>141.979494</td>
      <td>9.935785</td>
      <td>282.189348</td>
    </tr>
    <tr>
      <th>std</th>
      <td>44.121429</td>
      <td>0.774800</td>
      <td>464.909510</td>
      <td>18.651722</td>
      <td>233.934588</td>
      <td>8.445942</td>
      <td>233.942058</td>
      <td>8.446144</td>
      <td>465.744596</td>
    </tr>
    <tr>
      <th>min</th>
      <td>162.974000</td>
      <td>93.097000</td>
      <td>-24.975600</td>
      <td>9.561100</td>
      <td>0.000000</td>
      <td>-18.246000</td>
      <td>0.000000</td>
      <td>-18.246000</td>
      <td>-24.975600</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>296.000500</td>
      <td>96.671000</td>
      <td>0.000000</td>
      <td>75.080000</td>
      <td>0.000000</td>
      <td>3.260000</td>
      <td>0.000000</td>
      <td>3.261000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>326.284000</td>
      <td>97.116868</td>
      <td>7.931250</td>
      <td>95.714000</td>
      <td>3.443000</td>
      <td>9.660000</td>
      <td>3.443776</td>
      <td>9.661000</td>
      <td>8.303900</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>355.000000</td>
      <td>97.567000</td>
      <td>366.431000</td>
      <td>99.920400</td>
      <td>190.058500</td>
      <td>15.915000</td>
      <td>190.126500</td>
      <td>15.915000</td>
      <td>377.216250</td>
    </tr>
    <tr>
      <th>max</th>
      <td>454.942000</td>
      <td>100.449000</td>
      <td>2233.030000</td>
      <td>100.000000</td>
      <td>1098.310000</td>
      <td>36.349000</td>
      <td>1098.310000</td>
      <td>36.349000</td>
      <td>2233.030000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="keep-relevant-columns">
<h1><strong>Keep relevant columns</strong><a class="headerlink" href="#keep-relevant-columns" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_simple_merged</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Lwin_1_1_1&#39;, &#39;Pa_1_1_1&#39;, &#39;PPFD_1_1_1&#39;, &#39;RH_1_1_1&#39;, &#39;Rg_1_1_1&#39;, &#39;Ta_1_1_1&#39;, &#39;Rg_1_1_1_gfXG&#39;, &#39;Ta_1_1_1_gfXG&#39;, &#39;PPFD_1_1_1_gfXG&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">keepcols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lwin_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;RH_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Pa_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">,</span> <span class="s1">&#39;Ta_1_1_1_gfXG&#39;</span><span class="p">,</span> <span class="s1">&#39;PPFD_1_1_1_gfXG&#39;</span><span class="p">]</span>
<span class="n">data_simple_merged</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[</span><span class="n">keepcols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_simple_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lwin_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>Rg_1_1_1_gfXG</th>
      <th>Ta_1_1_1_gfXG</th>
      <th>PPFD_1_1_1_gfXG</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>331.462000</td>
      <td>NaN</td>
      <td>98.160000</td>
      <td>0.0</td>
      <td>2.241000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>331.462000</td>
      <td>NaN</td>
      <td>98.163000</td>
      <td>0.0</td>
      <td>2.273000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>330.270000</td>
      <td>NaN</td>
      <td>98.167000</td>
      <td>0.0</td>
      <td>2.305000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>330.270000</td>
      <td>NaN</td>
      <td>98.173000</td>
      <td>0.0</td>
      <td>2.284000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>323.555000</td>
      <td>NaN</td>
      <td>98.180000</td>
      <td>0.0</td>
      <td>2.264000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>304.613900</td>
      <td>99.99799</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>-1.919472</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>303.039890</td>
      <td>99.99799</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>-2.104678</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>302.093633</td>
      <td>99.99799</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>-2.089444</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>302.217307</td>
      <td>99.99799</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>-2.355761</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>298.392973</td>
      <td>99.99799</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>-2.578839</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 6 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="add-timestamp-columns-for-eddypro">
<h1><strong>Add timestamp columns for EddyPro</strong><a class="headerlink" href="#add-timestamp-columns-for-eddypro" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EddyPro needs two columns: date and time</span>
<span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span>
<span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">time</span>
<span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M&#39;</span><span class="p">))</span>

<span class="c1"># Move date and time columns to start of dataframe</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">data_simple_merged</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">data_simple_merged</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

<span class="n">data_simple_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>time</th>
      <th>Lwin_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>Rg_1_1_1_gfXG</th>
      <th>Ta_1_1_1_gfXG</th>
      <th>PPFD_1_1_1_gfXG</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>2005-01-01</td>
      <td>00:30</td>
      <td>331.462000</td>
      <td>NaN</td>
      <td>98.160000</td>
      <td>0.0</td>
      <td>2.241000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>2005-01-01</td>
      <td>01:00</td>
      <td>331.462000</td>
      <td>NaN</td>
      <td>98.163000</td>
      <td>0.0</td>
      <td>2.273000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>2005-01-01</td>
      <td>01:30</td>
      <td>330.270000</td>
      <td>NaN</td>
      <td>98.167000</td>
      <td>0.0</td>
      <td>2.305000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>2005-01-01</td>
      <td>02:00</td>
      <td>330.270000</td>
      <td>NaN</td>
      <td>98.173000</td>
      <td>0.0</td>
      <td>2.284000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>2005-01-01</td>
      <td>02:30</td>
      <td>323.555000</td>
      <td>NaN</td>
      <td>98.180000</td>
      <td>0.0</td>
      <td>2.264000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>2024-12-31</td>
      <td>22:00</td>
      <td>304.613900</td>
      <td>99.99799</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>-1.919472</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>2024-12-31</td>
      <td>22:30</td>
      <td>303.039890</td>
      <td>99.99799</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>-2.104678</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>2024-12-31</td>
      <td>23:00</td>
      <td>302.093633</td>
      <td>99.99799</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>-2.089444</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>2024-12-31</td>
      <td>23:30</td>
      <td>302.217307</td>
      <td>99.99799</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>-2.355761</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>2025-01-01</td>
      <td>00:00</td>
      <td>298.392973</td>
      <td>99.99799</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>-2.578839</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 8 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="add-units-for-eddypro-input-file">
<h1><strong>Add units for EddyPro input file</strong><a class="headerlink" href="#add-units-for-eddypro-input-file" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;yyyy-mm-dd&#39;</span><span class="p">),</span>
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;HH:MM&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Lwin_1_1_1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Lwin_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;W+1m-2&#39;</span><span class="p">),</span>
    <span class="s1">&#39;PPFD_1_1_1_gfXG&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;PPFD_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;umol+1m-2s-1&#39;</span><span class="p">),</span>
    <span class="s1">&#39;RH_1_1_1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;RH_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Rg_1_1_1_gfXG&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Rg_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;W+1m-2&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Ta_1_1_1_gfXG&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Ta_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Pa_1_1_1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Pa_1_1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;kPa&#39;</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">data_simple_merged</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">renaming_dict</span><span class="p">)</span>
<span class="n">data_simple_merged</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">data_simple_merged</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">data_simple_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>date</th>
      <th>time</th>
      <th>Lwin_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
      <th>PPFD_1_1_1</th>
    </tr>
    <tr>
      <th></th>
      <th>yyyy-mm-dd</th>
      <th>HH:MM</th>
      <th>W+1m-2</th>
      <th>%</th>
      <th>kPa</th>
      <th>W+1m-2</th>
      <th>C</th>
      <th>umol+1m-2s-1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>2005-01-01</td>
      <td>00:30</td>
      <td>331.462000</td>
      <td>NaN</td>
      <td>98.160000</td>
      <td>0.0</td>
      <td>2.241000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>2005-01-01</td>
      <td>01:00</td>
      <td>331.462000</td>
      <td>NaN</td>
      <td>98.163000</td>
      <td>0.0</td>
      <td>2.273000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>2005-01-01</td>
      <td>01:30</td>
      <td>330.270000</td>
      <td>NaN</td>
      <td>98.167000</td>
      <td>0.0</td>
      <td>2.305000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>2005-01-01</td>
      <td>02:00</td>
      <td>330.270000</td>
      <td>NaN</td>
      <td>98.173000</td>
      <td>0.0</td>
      <td>2.284000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>2005-01-01</td>
      <td>02:30</td>
      <td>323.555000</td>
      <td>NaN</td>
      <td>98.180000</td>
      <td>0.0</td>
      <td>2.264000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>2024-12-31</td>
      <td>22:00</td>
      <td>304.613900</td>
      <td>99.99799</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>-1.919472</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>2024-12-31</td>
      <td>22:30</td>
      <td>303.039890</td>
      <td>99.99799</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>-2.104678</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>2024-12-31</td>
      <td>23:00</td>
      <td>302.093633</td>
      <td>99.99799</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>-2.089444</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>2024-12-31</td>
      <td>23:30</td>
      <td>302.217307</td>
      <td>99.99799</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>-2.355761</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>2025-01-01</td>
      <td>00:00</td>
      <td>298.392973</td>
      <td>99.99799</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>-2.578839</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 8 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="set-missing-values-code-to-9999">
<h1><strong>Set missing values code</strong> to -9999<a class="headerlink" href="#set-missing-values-code-to-9999" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EddyPro needs missing values as -9999</span>
<span class="n">data_simple_merged</span> <span class="o">=</span> <span class="n">data_simple_merged</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
<span class="n">data_simple_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>date</th>
      <th>time</th>
      <th>Lwin_1_1_1</th>
      <th>RH_1_1_1</th>
      <th>Pa_1_1_1</th>
      <th>Rg_1_1_1</th>
      <th>Ta_1_1_1</th>
      <th>PPFD_1_1_1</th>
    </tr>
    <tr>
      <th></th>
      <th>yyyy-mm-dd</th>
      <th>HH:MM</th>
      <th>W+1m-2</th>
      <th>%</th>
      <th>kPa</th>
      <th>W+1m-2</th>
      <th>C</th>
      <th>umol+1m-2s-1</th>
    </tr>
    <tr>
      <th>TIMESTAMP_END</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-01 00:30:00</th>
      <td>2005-01-01</td>
      <td>00:30</td>
      <td>331.462000</td>
      <td>-9999.00000</td>
      <td>98.160000</td>
      <td>0.0</td>
      <td>2.241000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:00:00</th>
      <td>2005-01-01</td>
      <td>01:00</td>
      <td>331.462000</td>
      <td>-9999.00000</td>
      <td>98.163000</td>
      <td>0.0</td>
      <td>2.273000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 01:30:00</th>
      <td>2005-01-01</td>
      <td>01:30</td>
      <td>330.270000</td>
      <td>-9999.00000</td>
      <td>98.167000</td>
      <td>0.0</td>
      <td>2.305000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:00:00</th>
      <td>2005-01-01</td>
      <td>02:00</td>
      <td>330.270000</td>
      <td>-9999.00000</td>
      <td>98.173000</td>
      <td>0.0</td>
      <td>2.284000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>2005-01-01 02:30:00</th>
      <td>2005-01-01</td>
      <td>02:30</td>
      <td>323.555000</td>
      <td>-9999.00000</td>
      <td>98.180000</td>
      <td>0.0</td>
      <td>2.264000</td>
      <td>-0.269498</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-31 22:00:00</th>
      <td>2024-12-31</td>
      <td>22:00</td>
      <td>304.613900</td>
      <td>99.99799</td>
      <td>98.337089</td>
      <td>0.0</td>
      <td>-1.919472</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 22:30:00</th>
      <td>2024-12-31</td>
      <td>22:30</td>
      <td>303.039890</td>
      <td>99.99799</td>
      <td>98.305216</td>
      <td>0.0</td>
      <td>-2.104678</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:00:00</th>
      <td>2024-12-31</td>
      <td>23:00</td>
      <td>302.093633</td>
      <td>99.99799</td>
      <td>98.285114</td>
      <td>0.0</td>
      <td>-2.089444</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-12-31 23:30:00</th>
      <td>2024-12-31</td>
      <td>23:30</td>
      <td>302.217307</td>
      <td>99.99799</td>
      <td>98.289683</td>
      <td>0.0</td>
      <td>-2.355761</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2025-01-01 00:00:00</th>
      <td>2025-01-01</td>
      <td>00:00</td>
      <td>298.392973</td>
      <td>99.99799</td>
      <td>98.285661</td>
      <td>0.0</td>
      <td>-2.578839</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>350640 rows × 8 columns</p>
</div></div></div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="save-to-file">
<h1><strong>Save to file</strong><a class="headerlink" href="#save-to-file" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_simple_merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">OUTFILE</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="end-of-notebook">
<h1><strong>End of notebook</strong>.<a class="headerlink" href="#end-of-notebook" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_string</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finished. </span><span class="si">{</span><span class="n">dt_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished. 2025-01-22 14:31:34
</pre></div>
</div>
</div>
</div>
</br></section>
<section class="tex2jax_ignore mathjax_ignore" id="bonus">
<h1>(Bonus)<a class="headerlink" href="#bonus" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ta = data_simple_merged[(&#39;Ta_1_1_1&#39;, &#39;C&#39;)].copy()</span>
<span class="c1"># ta = TimestampSanitizer(data=ta).get()</span>
<span class="c1"># ta = ta.loc[ta.index.year &gt; 2005].copy()</span>
<span class="c1"># means = ta.groupby(ta.index.year).mean()</span>
<span class="c1"># means</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># means.sort_values(ascending=False).head(5)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># means.loc[means.index &gt; 2014].mean()</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Auto-settings</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-settings">Data settings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download"><strong>Download</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-fluxnet-meteo-data-2005-2023">Download FLUXNET meteo data (2005-2023)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-newest-meteo-data-from-diive-meteoscreening-2024">Download newest meteo data from diive meteoscreening (2024)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-units-if-needed"><strong>Adjust units</strong> (if needed)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-variables-for-merging-and-for-use-in-eddypro"><strong>Rename variables for merging and for use in EddyPro</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data"><strong>Merge data</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sanitize-timestamp"><strong>Sanitize timestamp</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#gap-filling"><strong>Gap-filling</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rg">Rg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ta">TA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ppfd">PPFD</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plots"><strong>Plots</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-plot">Time series plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heatmaps">Heatmaps</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats"><strong>Stats</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#keep-relevant-columns"><strong>Keep relevant columns</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-timestamp-columns-for-eddypro"><strong>Add timestamp columns for EddyPro</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-units-for-eddypro-input-file"><strong>Add units for EddyPro input file</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#set-missing-values-code-to-9999"><strong>Set missing values code</strong> to -9999</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-to-file"><strong>Save to file</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-notebook"><strong>End of notebook</strong>.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus">(Bonus)</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>